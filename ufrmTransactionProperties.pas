unit ufrmTransactionProperties;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ExtCtrls, SUIForm, RzGroupBar, RzPanel, StdCtrls, Mask, RzEdit,
  RzBtnEdt, RzLabel, cxStyles, cxCustomData, cxGraphics, cxFilter, cxData,
  cxDataStorage, cxEdit, DB, cxDBData, cxGridLevel, cxClasses, cxControls,
  cxGridCustomView, cxGridCustomTableView, cxGridTableView,
  cxGridDBTableView, cxGrid, RzCmboBx, ADODB, cxImageComboBox, ImgList,
  SUIButton, SUIProgressBar, SUIImagePanel, SUIGroupBox, RzButton, uConverNumberToString ;
type TfTRMode = (tmNew, tmEdit) ;
type TfTRResult = (trAccept, trCancel) ;
type
  TfrmTransactionProperties = class(TForm)
    suiForm1: TsuiForm;
    RzGroupBar1: TRzGroupBar;
    RzGroup1: TRzGroup;
    RzPanel1: TRzPanel;
    RzPanel2: TRzPanel;
    RzGroup2: TRzGroup;
    RzPanel3: TRzPanel;
    RzLabel1: TRzLabel;
    cxStyleRepository1: TcxStyleRepository;
    GridTableViewStyleSheetDevExpress: TcxGridTableViewStyleSheet;
    cxStyle1: TcxStyle;
    cxStyle2: TcxStyle;
    cxStyle3: TcxStyle;
    cxStyle4: TcxStyle;
    cxStyle5: TcxStyle;
    cxStyle6: TcxStyle;
    cxStyle7: TcxStyle;
    cxStyle8: TcxStyle;
    cxStyle9: TcxStyle;
    cxStyle10: TcxStyle;
    cxStyle11: TcxStyle;
    cxStyle12: TcxStyle;
    cxStyle13: TcxStyle;
    cxStyle14: TcxStyle;
    edtAmount: TRzEdit;
    DispHead: TRzLabel;
    edtAccountID: TRzEdit;
    RzLabel2: TRzLabel;
    edtBookQty: TRzEdit;
    ViewAccount: TcxGridDBTableView;
    cxGrid2Level1: TcxGridLevel;
    cxGrid2: TcxGrid;
    DBAccount: TADOQuery;
    DataSource1: TDataSource;
    ViewAccountACC_ID: TcxGridDBColumn;
    ViewAccountACC_Description: TcxGridDBColumn;
    ViewAccountACC_Mobile: TcxGridDBColumn;
    ViewAccountACC_Tel: TcxGridDBColumn;
    ViewAccountACC_EMail: TcxGridDBColumn;
    ViewAccountACC_Discount: TcxGridDBColumn;
    ViewAccountDBColumn1: TcxGridDBColumn;
    ImageList1: TImageList;
    DataSource2: TDataSource;
    ViewTR: TADOQuery;
    BRNDisp: TRzPanel;
    BankDisp: TRzPanel;
    RzGroup3: TRzGroup;
    DispDiscount: TRzPanel;
    DispPrice: TRzPanel;
    DispDocument: TRzPanel;
    DispFormatName: TRzPanel;
    RzLabel6: TRzLabel;
    edtChequeNO: TRzEdit;
    RzLabel7: TRzLabel;
    ListFormat: TRzComboBox;
    edtTC: TRzEdit;
    RzLabel3: TRzLabel;
    ImageList2: TImageList;
    suiGroupBox1: TsuiGroupBox;
    suiProgressBar1: TsuiProgressBar;
    RzLabel5: TRzLabel;
    Label1: TLabel;
    EdTC_Pos: TRzEdit;
    Chk_Repare: TsuiCheckBox;
    RzLabel8: TRzLabel;
    RzLabel9: TRzLabel;
    EdRevenue: TRzEdit;
    EdCommission: TRzEdit;
    EdSpecial: TRzEdit;
    EdEmbassy: TRzEdit;
    RdSpecial: TsuiRadioButton;
    RdEmbassy: TsuiRadioButton;
    RdNormal: TsuiRadioButton;
    edtAccountID2: TRzEdit;
    ViewACC_Adr1: TcxGridDBColumn;
    procedure RzGroup1Items0Click(Sender: TObject);
    procedure FormActivate(Sender: TObject);
    procedure edtAccountIDChange(Sender: TObject);
    procedure edtAccountIDKeyDown(Sender: TObject; var Key: Word;
      Shift: TShiftState);
    procedure ViewAccountDblClick(Sender: TObject);
    procedure edtChequeNOEnter(Sender: TObject);
    procedure ListFormatChange(Sender: TObject);
    procedure btnAddClick(Sender: TObject);
    procedure edtBookQtyKeyPress(Sender: TObject; var Key: Char);
    procedure edtAccountIDExit(Sender: TObject);
    procedure edtAccountIDEnter(Sender: TObject);
    procedure edtBookQtyChange(Sender: TObject);
    procedure edtBookQtyExit(Sender: TObject);
    procedure btnDelClick(Sender: TObject);
    procedure ViewTR1DblClick(Sender: TObject);
    procedure RzGroup1Items1Click(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure RzButton1Click(Sender: TObject);
    procedure Chk_RepareClick(Sender: TObject);
    procedure RdNormalClick(Sender: TObject);
    procedure RdSpecialClick(Sender: TObject);
    procedure RdEmbassyClick(Sender: TObject);
  private
    { Private declarations }
    fBank : String ;
    fBrn  : String ;
    fFormat : String ;
    fAccount : String ;
    fNewFormat : Boolean ;
    fJOBNO : String ;
    fDiscount : String ;
    fDiscountValues : Extended ;
    fUserID : String ;
    fPrice  : Extended ;
    fPriceItem : Extended ;
    fDiscItem  : Extended ;
    fTRMode : TfTRMode ;
    fTRResult : TfTRResult ;
    ConVertMoney : Tn2wMoney ;
    fFee : Extended ;
    fFeeItem : Extended ;

    fFDDocUsed : Boolean ;
    fBDDocUsed : Boolean ;
    fRDDocUsed : Boolean ;
    fBCDocUsed : Boolean ;

    fDocLen   : Integer ;
    fDocWidth : Integer ;
//    fNewFormat : Boolean ;

    fFDDocQty : Integer ;
    fBDDocQty : Integer ;
    fRDDocQty : Integer ;
    fBCDocQty : Integer ;

    fFDDocStRun : Integer ;
    fBDDocStRun : Integer ;
    fRDDocStRun : Integer ;
    fBCDocStRun : Integer ;

    fFDEStubChequeNo : Integer ;
    fFDEChequeNo     : Integer ;
    fFDEChequeEnd    : Integer ;
    fFDEBankID       : Integer ;
    fFDEBRNID        : Integer ;
    fFDEAccountID    : Integer ;
    fFDETC           : Integer ;
    fFDEAmount       : Integer ;
//    fFDEChequeEnd    : Boolean ;

    fFDESBStubChequeNo : String ;
    fFDESBChequeNo     : String ;
    fFDESBChequeEnd    : String ;
    fFDESBBankID       : String ;
    fFDESBBRNID        : String ;
    fFDESBAccountID    : String ;
    fFDESBTC           : String ;
    fFDESBAmount       : String ;
//    fFDESBChequeEnd    : Boolean ;

    fFDEStubChequeNoPOS : Integer ;
    fFDEChequeNoPOS     : Integer ;
    fFDEChequeEndPOS    : Integer ;
    fFDEBankIDPOS       : Integer ;
    fFDEBRNIDPOS        : Integer ;
    fFDEAccountIDPOS    : Integer ;
    fFDETCPOS           : Integer ;
    fFDEAmountPOS       : Integer ;
//    fFDEChequeEndPOS    : Integer ;


    fBDEStubChequeNo : Integer ;
    fBDEChequeNo     : Integer ;
    fBDEChequeEnd    : Integer ;
    fBDEBankID       : Integer ;
    fBDEBRNID        : Integer ;
    fBDEAccountID    : Integer ;
    fBDETC           : Integer ;
    fBDEAmount       : Integer ;
//    fBDEChequeEnd    : Boolean ;

    fBDESBStubChequeNo : String ;
    fBDESBChequeNo     : String ;
    fBDESBChequeEnd    : String ;
    fBDESBBankID       : String ;
    fBDESBBRNID        : String ;
    fBDESBAccountID    : String ;
    fBDESBTC           : String ;
    fBDESBAmount       : String ;
//    fBDESBChequeEnd    : Boolean ;

    fBDEStubChequeNoPOS : Integer ;
    fBDEChequeNoPOS     : Integer ;
    fBDEChequeEndPOS    : Integer ;
    fBDEBankIDPOS       : Integer ;
    fBDEBRNIDPOS        : Integer ;
    fBDEAccountIDPOS    : Integer ;
    fBDETCPOS           : Integer ;
    fBDEAmountPOS       : Integer ;
//    fBDEChequeEndPOS    : Integer ;

    fRDEStubChequeNo : Integer ;
    fRDEChequeNo     : Integer ;
    fRDEChequeEnd    : Integer ;
    fRDEBankID       : Integer ;
    fRDEBRNID        : Integer ;
    fRDEAccountID    : Integer ;
    fRDETC           : Integer ;
    fRDEAmount       : Integer ;
//    fRDEChequeEnd    : Boolean ;

    fRDESBStubChequeNo : String ;
    fRDESBChequeNo     : String ;
    fRDESBChequeEnd    : String ;
    fRDESBBankID       : String ;
    fRDESBBRNID        : String ;
    fRDESBAccountID    : String ;
    fRDESBTC           : String ;
    fRDESBAmount       : String ;
//    fRDESBChequeEnd    : Boolean ;

    fRDEStubChequeNoPOS : Integer ;
    fRDEChequeNoPOS     : Integer ;
    fRDEChequeEndPOS    : Integer ;
    fRDEBankIDPOS       : Integer ;
    fRDEBRNIDPOS        : Integer ;
    fRDEAccountIDPOS    : Integer ;
    fRDETCPOS           : Integer ;
    fRDEAmountPOS      : Integer ;
//    fRDEChequeEndPOS    : Integer ;

    fBCEStubChequeNo : Integer ;
    fBCEChequeNo    : Integer ;
    fBCEChequeEnd    : Integer ;
    fBCEBankID       : Integer ;
    fBCEBRNID        : Integer ;
    fBCEAccountID    : Integer ;
    fBCETC           : Integer ;
    fBCEAmount       : Integer ;
//    fBCEChequeEnd    : Boolean ;

    fBCESBStubChequeNo : String ;
    fBCESBChequeNo     : String ;
    fBCESBChequeEnd    : String ;
    fBCESBBankID       : String ;
    fBCESBBRNID        : String ;
    fBCESBAccountID    : String ;
    fBCESBTC           : String ;
    fBCESBAmount       : String ;
//    fBCESBChequeEnd    : Boolean ;

    fBCEStubChequeNoPOS : Integer ;
    fBCEChequeNoPOS     : Integer ;
    fBCEChequeEndPOS    : Integer ;
    fBCEBankIDPOS       : Integer ;
    fBCEBRNIDPOS        : Integer ;
    fBCEAccountIDPOS    : Integer ;
    fBCETCPOS           : Integer ;
    fBCEAmountPOS       : Integer ;
//    fBCEChequeEndPOS    : Integer ;

    fFDFontSize        : Integer ;
    fBDFontSize        : Integer ;
    fRDFontSize        : Integer ;
    fBCFontSize        : Integer ;

    fFDCharNum        : Integer ;
    fBDCharNum        : Integer ;
    fRDCharNum        : Integer ;
    fBCCharNum        : Integer ;

    fFDStartH1L1   : Integer ;
    fFDStartH1L2   : Integer ;
    fFDStartH1L3   : Integer ;
    fFDStartH1L4   : Integer ;

    fFDStartH2L1   : Integer ;
    fFDStartH2L2   : Integer ;
    fFDStartH2L3   : Integer ;
    fFDStartH2L4   : Integer ;


    fBDStartH1L1   : Integer ;
    fBDStartH1L2   : Integer ;
    fBDStartH1L3   : Integer ;
    fBDStartH1L4   : Integer ;

    fBDStartH2L1   : Integer ;
    fBDStartH2L2   : Integer ;
    fBDStartH2L3   : Integer ;
    fBDStartH2L4   : Integer ;


    fRDStartH1L1   : Integer ;
    fRDStartH1L2   : Integer ;
    fRDStartH1L3   : Integer ;
    fRDStartH1L4   : Integer ;

    fRDStartH2L1   : Integer ;
    fRDStartH2L2   : Integer ;
    fRDStartH2L3   : Integer ;
    fRDStartH2L4   : Integer ;

    fBCStartH1L1   : Integer ;
    fBCStartH1L2   : Integer ;
    fBCStartH1L3   : Integer ;
    fBCStartH1L4   : Integer ;

    fBCStartH2L1   : Integer ;
    fBCStartH2L2   : Integer ;
    fBCStartH2L3   : Integer ;
    fBCStartH2L4   : Integer ;

    fFDPL1H1F1     : String ;
    fFDPL1H1F2     : String ;
    fFDPL2H1F1     : String ;
    fFDPL2H1F2     : String ;
    fFDPL3H1F1     : String ;
    fFDPL3H1F2     : String ;
    fFDPL4H1F1     : String ;
    fFDPL4H1F2     : String ;

    fFDPL1H2F1     : String ;
    fFDPL1H2F2     : String ;
    fFDPL2H2F1     : String ;
    fFDPL2H2F2     : String ;
    fFDPL3H2F1     : String ;
    fFDPL3H2F2     : String ;
    fFDPL4H2F1     : String ;
    fFDPL4H2F2     : String ;

    fBDPL1H1F1     : String ;
    fBDPL1H1F2     : String ;
    fBDPL2H1F1     : String ;
    fBDPL2H1F2     : String ;
    fBDPL3H1F1     : String ;
    fBDPL3H1F2     : String ;
    fBDPL4H1F1     : String ;
    fBDPL4H1F2     : String ;

    fBDPL1H2F1     : String ;
    fBDPL1H2F2     : String ;
    fBDPL2H2F1     : String ;
    fBDPL2H2F2     : String ;
    fBDPL3H2F1     : String ;
    fBDPL3H2F2     : String ;
    fBDPL4H2F1     : String ;
    fBDPL4H2F2     : String ;

    fRDPL1H1F1     : String ;
    fRDPL1H1F2     : String ;
    fRDPL2H1F1     : String ;
    fRDPL2H1F2     : String ;
    fRDPL3H1F1     : String ;
    fRDPL3H1F2     : String ;
    fRDPL4H1F1     : String ;
    fRDPL4H1F2     : String ;

    fRDPL1H2F1     : String ;
    fRDPL1H2F2     : String ;
    fRDPL2H2F1     : String ;
    fRDPL2H2F2     : String ;
    fRDPL3H2F1     : String ;
    fRDPL3H2F2     : String ;
    fRDPL4H2F1     : String ;
    fRDPL4H2F2     : String ;

    fBCPL1H1F1     : String ;
    fBCPL1H1F2     : String ;
    fBCPL2H1F1     : String ;
    fBCPL2H1F2     : String ;
    fBCPL3H1F1     : String ;
    fBCPL3H1F2     : String ;
    fBCPL4H1F1     : String ;
    fBCPL4H1F2     : String ;

    fBCPL1H2F1     : String ;
    fBCPL1H2F2     : String ;
    fBCPL2H2F1     : String ;
    fBCPL2H2F2     : String ;
    fBCPL3H2F1     : String ;
    fBCPL3H2F2     : String ;
    fBCPL4H2F1     : String ;
    fBCPL4H2F2     : String ;

    fFDPStart : Integer ;
    fBDPStart : Integer ;
    fRDPStart : Integer ;
    fBCPStart : Integer ;

    fBankName : String ;
    fBankAdd1 : String ;
    fBankAdd2 : String ;
    fBankCity : String ;
    fBankReg  : String ;
    fBranchName :String ;
    fBranchAdd1   : String ;
    fBranchAdd2   : String ;
    fBranchCity   : String ;
    fBranchRegion : String ;

    fAccountName : String ;
    fAccountAdd1 : String ;
    fAccountAdd2 : String ;



{
            'Start Cheque Number','PSCN0') ;
            'End Cheque Number','PECN0') ;
            'Bank Code','PBKC0') ;
            'Bank Name','PBKN0') ;
            'Bank Address1','PBKA1') ;
            'Bank Address2','PBKA2') ;
            'Bank City','PBKCT') ;
            'Bank Region','PBKBR') ;
            'Branch Code','PBRC0') ;
            'Branch Name','PBRN0') ;
            'Branch Address1','PBRA1') ;
            'Branch Address2','PBRA2') ;
            'Branch City','PBRCT') ;
            'Branch Region','PBRBR') ;
            'Account ID','PACID') ;
            'Account Name','PACNA') ;
            'Account Address1','PACA1') ;
            'Account Address2','PACA2') ;
            'Qty','PEQTY') ;
            'Total Qty.','PTQTY') ;
             'Price','PEPRE') ;
            TRzComboBox(suiGroupBox10.Controls[Rec]).AddItemValue('Price Thai','PPRTH') ;
            TRzComboBox(suiGroupBox10.Controls[Rec]).AddItemValue('Price ENG','PPREN') ;
            ' '('Total Price','PTPRI') ;
            ' '('Discount','PDISC') ;
            ' '('Entry Data','PENTR') ;

}



    Procedure LoadFormat() ;
    Procedure GetBankDefault();
    Procedure GetBRNDefault();
    Procedure GetLoadAccount();
    Procedure LoadDetailFormat() ;
    Procedure StartJOB(inJOBNo : String);
    Procedure LoadTR();
    Procedure ShowScreen();
    Function CalTotalPrices() : Extended ;
    Function CalTotalDisc() : Extended ;
    Procedure ProcessData();
    Procedure LoadDetailFormat2(inFormat : String) ;
    Procedure CreateNewFormat() ;
    //===
    Procedure CreateCurrentFormatxx2();
    //===

    Procedure CreateCurrentFormat() ;
    Procedure CreateCurrentFormatxx() ;
    Function DoStang(inData : String; HaveDot : Boolean) : String;
    Function GetCheeckDigit(finChqSerail : String; finBankID : String; finBRNID : String; finAccountID : String) : String;

    procedure calAmt();

    procedure UpdBDDocQty(STransID,SDocNm:String);

  public
    { Public declarations }
  Published
    Property JOBNO : String Read fJOBNO Write StartJOB ;
    Property TRMode : TfTRMode Read fTRMode Write fTRMode ;
    Property TRResult : TfTRResult Read fTRResult Write fTRResult ;
  end;



var
  frmTransactionProperties: TfrmTransactionProperties;

implementation
uses ufrmDatacenter,  uConvertChar ;

{$R *.dfm}
Procedure TfrmTransactionProperties.LoadDetailFormat2(inFormat : String) ;
var DBFor : TADOQuery ;
    TempStr : String ;
    StrLine : TStringList ;

begin
   StrLine := TStringList.Create ;
   DBFor := TADOQuery.Create(nil);
     with DBFor do
       begin
         Connection := frmDataCenter.ADOConnection1 ;
         SQL.Clear ;
         SQL.Text := ' Select * from DBChequeProperties '+
                     ' Where FFM_Name = '+QuotedStr(inFormat) ;
         Active := true ;
         fFDDocUsed := FieldByName('FFM_FDUse').AsBoolean ;
         fBDDocUsed := FieldByName('FFM_BDUse').AsBoolean ;
         fRDDocUsed := FieldByName('FFM_RDUse').AsBoolean ;
         fBCDocUsed := FieldByName('FFM_BCUse').AsBoolean ;

         fDocLen   := FieldByName('FFM_Length').AsInteger ;
         fDocWidth := FieldByName('FFM_Width').AsInteger ;

         fFDDocQty := FieldByName('FFM_FDQty').AsInteger ;
         fBDDocQty := FieldByName('FFM_BDQty').AsInteger ;
         fRDDocQty := FieldByName('FFM_RDQty').AsInteger ;
         fBCDocQty := FieldByName('FFM_BCQty').AsInteger ;

         fFDDocStRun := FieldByName('FFM_FDRunning').AsInteger ;
         fBDDocStRun := FieldByName('FFM_BDRunning').AsInteger ;
         fRDDocStRun := FieldByName('FFM_RDRunning').AsInteger ;
         fBCDocStRun := FieldByName('FFM_BCRunning').AsInteger ;



    fFDEStubChequeNo := StrToIntdef(Copy(FieldByName('FFM_FDECData').AsString,1,1),0) ;
    fFDEChequeNo     := StrToIntdef(Copy(FieldByName('FFM_FDECData').AsString,2,1),0) ;
//    fFDEChequeEnd    := StrToIntdef(Copy(FieldByName('FFM_FDECData').AsString,3,1),0) ;
    fFDEBankID       := StrToIntdef(Copy(FieldByName('FFM_FDECData').AsString,3,1),0) ;
    fFDEBRNID        := StrToIntdef(Copy(FieldByName('FFM_FDECData').AsString,4,1),0) ;
    fFDEAccountID    := StrToIntdef(Copy(FieldByName('FFM_FDECData').AsString,5,1),0) ;
    fFDETC           := StrToIntdef(Copy(FieldByName('FFM_FDECData').AsString,6,1),0) ;
    fFDEAmount       := StrToIntdef(Copy(FieldByName('FFM_FDECData').AsString,7,1),0) ;
    fFDEChequeEnd    := StrToIntdef(Copy(FieldByName('FFM_FDECData').AsString,8,1),0) ;

    fFDESBStubChequeNo := Copy(FieldByName('FFM_FDECSymbol').AsString,1,1) ;
    fFDESBChequeNo     := Copy(FieldByName('FFM_FDECSymbol').AsString,2,1) ;
//    fFDESBChequeEnd    := Copy(FieldByName('FFM_FDECSymbol').AsString,3,1) ;
    fFDESBBankID       := Copy(FieldByName('FFM_FDECSymbol').AsString,3,1) ;
    fFDESBBRNID        := Copy(FieldByName('FFM_FDECSymbol').AsString,4,1) ;
    fFDESBAccountID    := Copy(FieldByName('FFM_FDECSymbol').AsString,5,1) ;
    fFDESBTC           := Copy(FieldByName('FFM_FDECSymbol').AsString,6,1) ;
    fFDESBAmount       := Copy(FieldByName('FFM_FDECSymbol').AsString,7,1) ;
    fFDESBChequeEnd    := Copy(FieldByName('FFM_FDECSymbol').AsString,8,1) ;

    fBDEStubChequeNo := StrToIntdef(Copy(FieldByName('FFM_BDECData').AsString,1,1),0) ;
    fBDEChequeNo     := StrToIntdef(Copy(FieldByName('FFM_BDECData').AsString,2,1),0) ;
//    fBDEChequeEnd    := StrToIntdef(Copy(FieldByName('FFM_BDECData').AsString,3,1),0) ;
    fBDEBankID       := StrToIntdef(Copy(FieldByName('FFM_BDECData').AsString,3,1),0) ;
    fBDEBRNID        := StrToIntdef(Copy(FieldByName('FFM_BDECData').AsString,4,1),0) ;
    fBDEAccountID    := StrToIntdef(Copy(FieldByName('FFM_BDECData').AsString,5,1),0) ;
    fBDETC           := StrToIntdef(Copy(FieldByName('FFM_BDECData').AsString,6,1),0) ;
    fBDEAmount       := StrToIntdef(Copy(FieldByName('FFM_BDECData').AsString,7,1),0) ;
    fBDEChequeEnd    := StrToIntdef(Copy(FieldByName('FFM_BDECData').AsString,8,1),0) ;

    fBDESBStubChequeNo := Copy(FieldByName('FFM_BDECSymbol').AsString,1,1) ;
    fBDESBChequeNo     := Copy(FieldByName('FFM_BDECSymbol').AsString,2,1) ;
//    fBDESBChequeEnd    := Copy(FieldByName('FFM_BDECSymbol').AsString,3,1) ;
    fBDESBBankID       := Copy(FieldByName('FFM_BDECSymbol').AsString,3,1) ;
    fBDESBBRNID        := Copy(FieldByName('FFM_BDECSymbol').AsString,4,1) ;
    fBDESBAccountID    := Copy(FieldByName('FFM_BDECSymbol').AsString,5,1) ;
    fBDESBTC           := Copy(FieldByName('FFM_BDECSymbol').AsString,6,1) ;
    fBDESBAmount       := Copy(FieldByName('FFM_BDECSymbol').AsString,7,1) ;
    fBDESBChequeEnd    := Copy(FieldByName('FFM_BDECSymbol').AsString,8,1) ;

    fRDEStubChequeNo := StrToIntdef(Copy(FieldByName('FFM_RDECData').AsString,1,1),0) ;
    fRDEChequeNo     := StrToIntdef(Copy(FieldByName('FFM_RDECData').AsString,2,1),0) ;
//    fRDEChequeEnd    := StrToIntdef(Copy(FieldByName('FFM_RDECData').AsString,3,1),0) ;
    fRDEBankID       := StrToIntdef(Copy(FieldByName('FFM_RDECData').AsString,3,1),0) ;
    fRDEBRNID        := StrToIntdef(Copy(FieldByName('FFM_RDECData').AsString,4,1),0) ;
    fRDEAccountID    := StrToIntdef(Copy(FieldByName('FFM_RDECData').AsString,5,1),0) ;
    fRDETC           := StrToIntdef(Copy(FieldByName('FFM_RDECData').AsString,6,1),0) ;
    fRDEAmount       := StrToIntdef(Copy(FieldByName('FFM_RDECData').AsString,7,1),0) ;
    fRDEChequeEnd    := StrToIntdef(Copy(FieldByName('FFM_RDECData').AsString,8,1),0) ;

    fRDESBStubChequeNo := Copy(FieldByName('FFM_RDECSymbol').AsString,1,1) ;
    fRDESBChequeNo     := Copy(FieldByName('FFM_RDECSymbol').AsString,2,1) ;
//    fRDESBChequeEnd    := Copy(FieldByName('FFM_RDECSymbol').AsString,3,1) ;
    fRDESBBankID       := Copy(FieldByName('FFM_RDECSymbol').AsString,3,1) ;
    fRDESBBRNID        := Copy(FieldByName('FFM_RDECSymbol').AsString,4,1) ;
    fRDESBAccountID    := Copy(FieldByName('FFM_RDECSymbol').AsString,5,1) ;
    fRDESBTC           := Copy(FieldByName('FFM_RDECSymbol').AsString,6,1) ;
    fRDESBAmount       := Copy(FieldByName('FFM_RDECSymbol').AsString,7,1) ;
    fRDESBChequeEnd    := Copy(FieldByName('FFM_RDECSymbol').AsString,8,1) ;

    fBCEStubChequeNo := StrToIntdef(Copy(FieldByName('FFM_BCECData').AsString,1,1),0) ;
    fBCEChequeNo    := StrToIntdef(Copy(FieldByName('FFM_BCECData').AsString,2,1),0) ;
//    fBCEChequeEnd    := StrToIntdef(Copy(FieldByName('FFM_BCECData').AsString,3,1),0) ;
    fBCEBankID       := StrToIntdef(Copy(FieldByName('FFM_BCECData').AsString,3,1),0) ;
    fBCEBRNID        := StrToIntdef(Copy(FieldByName('FFM_BCECData').AsString,4,1),0) ;
    fBCEAccountID    := StrToIntdef(Copy(FieldByName('FFM_BCECData').AsString,5,1),0) ;
    fBCETC           := StrToIntdef(Copy(FieldByName('FFM_BCECData').AsString,6,1),0) ;
    fBCEAmount       := StrToIntdef(Copy(FieldByName('FFM_BCECData').AsString,7,1),0) ;
    fBCEChequeEnd    := StrToIntdef(Copy(FieldByName('FFM_BCECData').AsString,8,1),0) ;

    fBCESBStubChequeNo := Copy(FieldByName('FFM_BCECSymbol').AsString,1,1) ;
    fBCESBChequeNo     := Copy(FieldByName('FFM_BCECSymbol').AsString,2,1) ;
//    fBCESBChequeEnd    := Copy(FieldByName('FFM_BCECSymbol').AsString,3,1) ;
    fBCESBBankID       := Copy(FieldByName('FFM_BCECSymbol').AsString,3,1) ;
    fBCESBBRNID        := Copy(FieldByName('FFM_BCECSymbol').AsString,4,1) ;
    fBCESBAccountID    := Copy(FieldByName('FFM_BCECSymbol').AsString,5,1) ;
    fBCESBTC           := Copy(FieldByName('FFM_BCECSymbol').AsString,6,1) ;
    fBCESBAmount       := Copy(FieldByName('FFM_BCECSymbol').AsString,7,1) ;
    fBCESBChequeEnd    := Copy(FieldByName('FFM_BCECSymbol').AsString,8,1) ;

    fFDFontSize        := FieldByName('FFM_FDPRFontSize').AsInteger ;
    fBDFontSize        := FieldByName('FFM_BDPRFontSize').AsInteger ;
    fRDFontSize        := FieldByName('FFM_RDPRFontSize').AsInteger ;
    fBCFontSize        := FieldByName('FFM_BCPRFontSize').AsInteger ;

    //=== Lenght of Customer Name===
    fFDCharNum        := (FieldByName('FFM_FDPRCharNum').AsInteger)+1 ;
    fBDCharNum        := (FieldByName('FFM_BDPRCharNum').AsInteger)+1 ;
    fRDCharNum        := (FieldByName('FFM_RDPRCharNum').AsInteger)+1 ;
    fBCCharNum        := (FieldByName('FFM_BCPRCharNum').AsInteger)+1 ;
    //=== Lenght of Customer Name===

    TempStr :=  FieldByName('FFM_FDPRStartPrintH1').AsString ;
    StrLine.Clear ;
    StrLine.CommaText := TempStr ;


    fFDStartH1L1   := StrToIntDef(StrLine.Strings[0],0) ;
    fFDStartH1L2   := StrToIntDef(StrLine.Strings[1],0) ;
    fFDStartH1L3   := StrToIntDef(StrLine.Strings[2],0) ;
    fFDStartH1L4   := StrToIntDef(StrLine.Strings[3],0) ;

    TempStr :=  FieldByName('FFM_FDPRStartPrintH2').AsString ;
    StrLine.Clear ;
    StrLine.CommaText := TempStr ;

    fFDStartH2L1   := StrToIntDef(StrLine.Strings[0],0) ;
    fFDStartH2L2   := StrToIntDef(StrLine.Strings[1],0) ;
    fFDStartH2L3   := StrToIntDef(StrLine.Strings[2],0) ;
    fFDStartH2L4   := StrToIntDef(StrLine.Strings[3],0) ;

    TempStr :=  FieldByName('FFM_BDPRStartPrintH1').AsString ;
    StrLine.Clear ;
    StrLine.CommaText := TempStr ;

    fBDStartH1L1   := StrToIntDef(StrLine.Strings[0],0) ;
    fBDStartH1L2   := StrToIntDef(StrLine.Strings[1],0) ;
    fBDStartH1L3   := StrToIntDef(StrLine.Strings[2],0) ;
    fBDStartH1L4   := StrToIntDef(StrLine.Strings[3],0) ;

    TempStr :=  FieldByName('FFM_BDPRStartPrintH2').AsString ;
    StrLine.Clear ;
    StrLine.CommaText := TempStr ;

    fBDStartH2L1   := StrToIntDef(StrLine.Strings[0],0) ;
    fBDStartH2L2   := StrToIntDef(StrLine.Strings[1],0) ;
    fBDStartH2L3   := StrToIntDef(StrLine.Strings[2],0) ;
    fBDStartH2L4   := StrToIntDef(StrLine.Strings[3],0) ;

    TempStr :=  FieldByName('FFM_RDPRStartPrintH1').AsString ;
    StrLine.Clear ;
    StrLine.CommaText := TempStr ;

    fRDStartH1L1   := StrToIntDef(StrLine.Strings[0],0) ;
    fRDStartH1L2   := StrToIntDef(StrLine.Strings[1],0) ;
    fRDStartH1L3   := StrToIntDef(StrLine.Strings[2],0) ;
    fRDStartH1L4   := StrToIntDef(StrLine.Strings[3],0) ;

    TempStr :=  FieldByName('FFM_RDPRStartPrintH2').AsString ;
    StrLine.Clear ;
    StrLine.CommaText := TempStr ;

    fRDStartH2L1   := StrToIntDef(StrLine.Strings[0],0) ;
    fRDStartH2L2   := StrToIntDef(StrLine.Strings[1],0) ;
    fRDStartH2L3   := StrToIntDef(StrLine.Strings[2],0) ;
    fRDStartH2L4   := StrToIntDef(StrLine.Strings[3],0) ;

    TempStr :=  FieldByName('FFM_BCPRStartPrintH1').AsString ;
    StrLine.Clear ;
    StrLine.CommaText := TempStr ;


    fBCStartH1L1   := StrToIntDef(StrLine.Strings[0],0) ;
    fBCStartH1L2   := StrToIntDef(StrLine.Strings[1],0) ;
    fBCStartH1L3   := StrToIntDef(StrLine.Strings[2],0) ;
    fBCStartH1L4   := StrToIntDef(StrLine.Strings[3],0) ;

    TempStr :=  FieldByName('FFM_BCPRStartPrintH2').AsString ;
    StrLine.Clear ;
    StrLine.CommaText := TempStr ;

    fBCStartH2L1   := StrToIntDef(StrLine.Strings[0],0) ;
    fBCStartH2L2   := StrToIntDef(StrLine.Strings[1],0) ;
    fBCStartH2L3   := StrToIntDef(StrLine.Strings[2],0) ;
    fBCStartH2L4   := StrToIntDef(StrLine.Strings[3],0) ;

//    TempStr :=  FieldByName('FFM_FDPRPrintLine1H1').AsString ;
//    StrLine.Clear ;
//    StrLine.CommaText := TempStr ;


    fFDPL1H1F1     := Copy(FieldByName('FFM_FDPRPrintLine1H1').AsString,1,5) ;
    fFDPL1H1F2     := Copy(FieldByName('FFM_FDPRPrintLine1H1').AsString,6,5) ;
    fFDPL2H1F1     := Copy(FieldByName('FFM_FDPRPrintLine2H1').AsString,1,5) ;
    fFDPL2H1F2     := Copy(FieldByName('FFM_FDPRPrintLine2H1').AsString,6,5) ;
    fFDPL3H1F1     := Copy(FieldByName('FFM_FDPRPrintLine3H1').AsString,1,5) ;
    fFDPL3H1F2     := Copy(FieldByName('FFM_FDPRPrintLine3H1').AsString,6,5) ;
    fFDPL4H1F1     := Copy(FieldByName('FFM_FDPRPrintLine4H1').AsString,1,5) ;
    fFDPL4H1F2     := Copy(FieldByName('FFM_FDPRPrintLine4H1').AsString,6,5) ;

    fFDPL1H2F1     := Copy(FieldByName('FFM_FDPRPrintLine1H2').AsString,1,5) ;
    fFDPL1H2F2     := Copy(FieldByName('FFM_FDPRPrintLine1H2').AsString,6,5) ;
    fFDPL2H2F1     := Copy(FieldByName('FFM_FDPRPrintLine2H2').AsString,1,5) ;
    fFDPL2H2F2     := Copy(FieldByName('FFM_FDPRPrintLine2H2').AsString,6,5) ;
    fFDPL3H2F1     := Copy(FieldByName('FFM_FDPRPrintLine3H2').AsString,1,5) ;
    fFDPL3H2F2     := Copy(FieldByName('FFM_FDPRPrintLine3H2').AsString,6,5) ;
    fFDPL4H2F1     := Copy(FieldByName('FFM_FDPRPrintLine4H2').AsString,1,5) ;
    fFDPL4H2F2     := Copy(FieldByName('FFM_FDPRPrintLine4H2').AsString,6,5) ;

    fBDPL1H1F1     := Copy(FieldByName('FFM_BDPRPrintLine1H1').AsString,1,5) ;
    fBDPL1H1F2     := Copy(FieldByName('FFM_BDPRPrintLine1H1').AsString,6,5) ;
    fBDPL2H1F1     := Copy(FieldByName('FFM_BDPRPrintLine2H1').AsString,1,5) ;
    fBDPL2H1F2     := Copy(FieldByName('FFM_BDPRPrintLine2H1').AsString,6,5) ;
    fBDPL3H1F1     := Copy(FieldByName('FFM_BDPRPrintLine3H1').AsString,1,5) ;
    fBDPL3H1F2     := Copy(FieldByName('FFM_BDPRPrintLine3H1').AsString,6,5) ;
    fBDPL4H1F1     := Copy(FieldByName('FFM_BDPRPrintLine4H1').AsString,1,5) ;
    fBDPL4H1F2     := Copy(FieldByName('FFM_BDPRPrintLine4H1').AsString,6,5) ;

    fBDPL1H2F1     := Copy(FieldByName('FFM_BDPRPrintLine1H2').AsString,1,5) ;
    fBDPL1H2F2     := Copy(FieldByName('FFM_BDPRPrintLine1H2').AsString,6,5) ;
    fBDPL2H2F1     := Copy(FieldByName('FFM_BDPRPrintLine2H2').AsString,1,5) ;
    fBDPL2H2F2     := Copy(FieldByName('FFM_BDPRPrintLine2H2').AsString,6,5) ;
    fBDPL3H2F1     := Copy(FieldByName('FFM_BDPRPrintLine3H2').AsString,1,5) ;
    fBDPL3H2F2     := Copy(FieldByName('FFM_BDPRPrintLine3H2').AsString,6,5) ;
    fBDPL4H2F1     := Copy(FieldByName('FFM_BDPRPrintLine4H2').AsString,1,5) ;
    fBDPL4H2F2     := Copy(FieldByName('FFM_BDPRPrintLine4H2').AsString,6,5) ;

    fRDPL1H1F1     := Copy(FieldByName('FFM_RDPRPrintLine1H1').AsString,1,5) ;
    fRDPL1H1F2     := Copy(FieldByName('FFM_RDPRPrintLine1H1').AsString,6,5) ;
    fRDPL2H1F1     := Copy(FieldByName('FFM_RDPRPrintLine2H1').AsString,1,5) ;
    fRDPL2H1F2     := Copy(FieldByName('FFM_RDPRPrintLine2H1').AsString,6,5) ;
    fRDPL3H1F1     := Copy(FieldByName('FFM_RDPRPrintLine3H1').AsString,1,5) ;
    fRDPL3H1F2     := Copy(FieldByName('FFM_RDPRPrintLine3H1').AsString,6,5) ;
    fRDPL4H1F1     := Copy(FieldByName('FFM_RDPRPrintLine4H1').AsString,1,5) ;
    fRDPL4H1F2     := Copy(FieldByName('FFM_RDPRPrintLine4H1').AsString,6,5) ;

    fRDPL1H2F1     := Copy(FieldByName('FFM_RDPRPrintLine1H2').AsString,1,5) ;
    fRDPL1H2F2     := Copy(FieldByName('FFM_RDPRPrintLine1H2').AsString,6,5) ;
    fRDPL2H2F1     := Copy(FieldByName('FFM_RDPRPrintLine2H2').AsString,1,5) ;
    fRDPL2H2F2     := Copy(FieldByName('FFM_RDPRPrintLine2H2').AsString,6,5) ;
    fRDPL3H2F1     := Copy(FieldByName('FFM_RDPRPrintLine3H2').AsString,1,5) ;
    fRDPL3H2F2     := Copy(FieldByName('FFM_RDPRPrintLine3H2').AsString,6,5) ;
    fRDPL4H2F1     := Copy(FieldByName('FFM_RDPRPrintLine4H2').AsString,1,5) ;
    fRDPL4H2F2     := Copy(FieldByName('FFM_RDPRPrintLine4H2').AsString,6,5) ;

    fBCPL1H1F1     := Copy(FieldByName('FFM_RDPRPrintLine1H1').AsString,1,5) ;
    fBCPL1H1F2     := Copy(FieldByName('FFM_RDPRPrintLine1H1').AsString,6,5) ;
    fBCPL2H1F1     := Copy(FieldByName('FFM_RDPRPrintLine2H1').AsString,1,5) ;
    fBCPL2H1F2     := Copy(FieldByName('FFM_RDPRPrintLine2H1').AsString,6,5) ;
    fBCPL3H1F1     := Copy(FieldByName('FFM_RDPRPrintLine3H1').AsString,1,5) ;
    fBCPL3H1F2     := Copy(FieldByName('FFM_RDPRPrintLine3H1').AsString,6,5) ;
    fBCPL4H1F1     := Copy(FieldByName('FFM_RDPRPrintLine4H1').AsString,1,5) ;
    fBCPL4H1F2     := Copy(FieldByName('FFM_RDPRPrintLine4H1').AsString,6,5) ;

    fBCPL1H2F1     := Copy(FieldByName('FFM_RDPRPrintLine1H2').AsString,1,5) ;
    fBCPL1H2F2     := Copy(FieldByName('FFM_RDPRPrintLine1H2').AsString,6,5) ;
    fBCPL2H2F1     := Copy(FieldByName('FFM_RDPRPrintLine2H2').AsString,1,5) ;
    fBCPL2H2F2     := Copy(FieldByName('FFM_RDPRPrintLine2H2').AsString,6,5) ;
    fBCPL3H2F1     := Copy(FieldByName('FFM_RDPRPrintLine3H2').AsString,1,5) ;
    fBCPL3H2F2     := Copy(FieldByName('FFM_RDPRPrintLine3H2').AsString,6,5) ;
    fBCPL4H2F1     := Copy(FieldByName('FFM_RDPRPrintLine4H2').AsString,1,5) ;
    fBCPL4H2F2     := Copy(FieldByName('FFM_RDPRPrintLine4H2').AsString,6,5) ;


    TempStr :=  FieldByName('FFM_FDENPosition').AsString ;
    StrLine.Clear ;
    StrLine.CommaText := TempStr ;

    fFDEStubChequeNoPOS := StrToIntDef(StrLine.Strings[0],0) ;
    fFDEChequeNoPOS     := StrToIntDef(StrLine.Strings[1],0) ;
//    fFDEChequeEndPOS    := StrToIntDef(StrLine.Strings[2],0) ;
    fFDEBankIDPOS       := StrToIntDef(StrLine.Strings[2],0) ;
    fFDEBRNIDPOS        := StrToIntDef(StrLine.Strings[3],0) ;
    fFDEAccountIDPOS    := StrToIntDef(StrLine.Strings[4],0) ;
    fFDETCPOS           := StrToIntDef(StrLine.Strings[5],0) ;
    fFDEAmountPOS       := StrToIntDef(StrLine.Strings[6],0) ;
    fFDEChequeEndPOS    := StrToIntDef(StrLine.Strings[7],0) ;


    TempStr :=  FieldByName('FFM_BDENPosition').AsString ;
    StrLine.Clear ;
    StrLine.CommaText := TempStr ;

    fBDEStubChequeNoPOS := StrToIntDef(StrLine.Strings[0],0) ;
    fBDEChequeNoPOS     := StrToIntDef(StrLine.Strings[1],0) ;
//    fBDEChequeEndPOS    := StrToIntDef(StrLine.Strings[2],0) ;
    fBDEBankIDPOS       := StrToIntDef(StrLine.Strings[2],0) ;
    fBDEBRNIDPOS        := StrToIntDef(StrLine.Strings[3],0) ;
    fBDEAccountIDPOS    := StrToIntDef(StrLine.Strings[4],0) ;
    fBDETCPOS           := StrToIntDef(StrLine.Strings[5],0) ;
    fBDEAmountPOS       := StrToIntDef(StrLine.Strings[6],0) ;
    fBDEChequeEndPOS    := StrToIntDef(StrLine.Strings[7],0) ;

    TempStr :=  FieldByName('FFM_RDENPosition').AsString ;
    StrLine.Clear ;
    StrLine.CommaText := TempStr ;

    fRDEStubChequeNoPOS := StrToIntDef(StrLine.Strings[0],0) ;
    fRDEChequeNoPOS     := StrToIntDef(StrLine.Strings[1],0) ;
//    fRDEChequeEndPOS    := StrToIntDef(StrLine.Strings[2],0) ;
    fRDEBankIDPOS       := StrToIntDef(StrLine.Strings[2],0) ;
    fRDEBRNIDPOS        := StrToIntDef(StrLine.Strings[3],0) ;
    fRDEAccountIDPOS    := StrToIntDef(StrLine.Strings[4],0) ;
    fRDETCPOS           := StrToIntDef(StrLine.Strings[5],0) ;
    fRDEAmountPOS       := StrToIntDef(StrLine.Strings[6],0) ;
    fRDEChequeEndPOS    := StrToIntDef(StrLine.Strings[7],0) ;


    TempStr :=  FieldByName('FFM_BCENPosition').AsString ;
    StrLine.Clear ;
    StrLine.CommaText := TempStr ;

    fBCEStubChequeNoPOS := StrToIntDef(StrLine.Strings[0],0) ;
    fBCEChequeNoPOS     := StrToIntDef(StrLine.Strings[1],0) ;
//    fBCEChequeEndPOS    := StrToIntDef(StrLine.Strings[2],0) ;
    fBCEBankIDPOS       := StrToIntDef(StrLine.Strings[2],0) ;
    fBCEBRNIDPOS        := StrToIntDef(StrLine.Strings[3],0) ;
    fBCEAccountIDPOS    := StrToIntDef(StrLine.Strings[4],0) ;
    fBCETCPOS           := StrToIntDef(StrLine.Strings[5],0) ;
    fBCEAmountPOS        := StrToIntDef(StrLine.Strings[6],0) ;
    fBCEChequeEndPOS    := StrToIntDef(StrLine.Strings[7],0) ;

    fFDPStart := FieldByName('FFM_FDPStart').AsInteger ;
    fBDPStart := FieldByName('FFM_BDPStart').AsInteger ;
    fRDPStart := FieldByName('FFM_RDPStart').AsInteger ;
    fBCPStart := FieldByName('FFM_BCPStart').AsInteger ;

         Active := false ;
         Free ;
       end;
end ;


Procedure TfrmTransactionProperties.StartJOB(inJOBNo : String);
begin
  fJOBNO := inJOBNo ;
  fTRResult := trCancel ;
       fUserID := frmDataCenter.UserID ;
     fBank   := frmDataCenter.BankID ;
     fBrn    := frmDataCenter.BRNID ;


     LoadFormat() ;
     GetLoadAccount ;
     LoadTR ;

  Case fTRMode of
    tmNew : begin
              DispHead.Caption := fJOBNO+' (New)' ;
              edtAccountID.ReadOnly := false ;
            end;
    tmEdit : begin
              DispHead.Caption := fJOBNO+' (Edit)' ;
              edtAccountID.ReadOnly := true ;
              ShowScreen ;
             end;
  end ;

end;

Procedure TfrmTransactionProperties.ShowScreen();
var DBTRS : TADOQuery ;
    Sender : TObject ;
begin
   DBTRS := TADOQuery.Create(nil);
     with DBTRS do
       begin
        Connection := frmDataCenter.ADOConnection1 ;
        SQL.Clear ;
        SQL.Text := ' Select * from DBTransactionDetails '+
                    ' Where TRD_JobID = '+ QuotedStr(fJOBNO) ;
        Active := true ;

         edtAccountID.Text := trim(FieldByname('TRD_AccountID').AsString)+' '+trim(FieldByname('TRD_AccountName').AsString) ;
         fAccount := trim(FieldByname('TRD_AccountID').AsString) ;
         ListFormat.ItemIndex := ListFormat.Items.IndexOf(trim(FieldByname('TRD_FormatID').AsString)) ;
         edtChequeNO.Text := trim(FieldByname('TRD_SerialNo').AsString) ;
         edtBookQty.Text := trim(FieldByname('TRD_BookQty').AsString) ;
         edtTC.Text := trim(FieldByname('TRD_TC').AsString) ;
         edtAmount.Text := trim(FieldByname('TRD_Amount').AsString) ;
        Active := false ;
        Free ;
       end;
//  LoadTR();
//  ViewTR1DblClick(Sender) ;
end;

Procedure TfrmTransactionProperties.LoadTR();
begin
  if(ViewTR.Active) then ViewTR.Active := false ;
    with ViewTR do
     begin
       Connection := frmDataCenter.ADOConnection1 ;
       SQL.Clear ;
       SQL.Text := ' Select * from DBTransactionDetails '+
                   ' where TRD_JobID = '+QuotedStr(fJOBNO) ;
       Active := true ;
     end;
end;

Procedure TfrmTransactionProperties.GetBankDefault();
var DBBank : TADOQuery ;
begin
   DBBank := TADOQuery.Create(nil);
     with DBBank do
       begin
         Connection := frmDataCenter.ADOConnection1 ;
         SQL.Clear ;
         SQL.Text := ' Select * from DBOfficeMaster '+
                     ' Where HOF_ID =  '+quotedStr(fBank) ;
         Active := true ;
//         fBank := trim(FieldByname('HOF_ID').AsString) ;
         //fBankName := trim(FieldByname('HOF_LocalDescr').AsString) ;
         fBankName := trim(FieldByname('HOF_InternationsDescr').AsString) ;
         fBankAdd1 := trim(FieldByname('HOF_Address1').AsString) ;
         fBankAdd2 := trim(FieldByname('HOF_Address2').AsString) ;
         fBankCity := trim(FieldByname('HOF_Region').AsString) ;
         fBankReg  := trim(FieldByname('HOF_City').AsString) ;

         BankDisp.Caption :=  'ธนาคาร : '+trim(FieldByname('HOF_ID').AsString)+' '+trim(FieldByname('HOF_LocalDescr').AsString) ;
         Active := false ;
         Free ;
       end;
end;

Procedure TfrmTransactionProperties.GetBRNDefault();
var DBBrn : TADOQuery ;
begin
   DBBrn := TADOQuery.Create(nil);
     with DBBrn do
       begin
         Connection := frmDataCenter.ADOConnection1 ;
         SQL.Clear ;
         SQL.Text := ' Select * from DBBranchesMaster '+
                     ' Where BOF_OnwerOffice = '+QuotedStr(fBank)+
                     ' and BOF_ID =  '+QuotedStr(fBrn) ;
         Active := true ;
//          fBrn  := trim(FieldByname('BOF_ID').AsString) ;
         //fBranchName  :=  trim(FieldByname('BOF_LocalDescr').AsString) ;
         fBranchName  :=  trim(FieldByname('BOF_InterNationDescr').AsString) ;
         fBranchAdd1   :=  trim(FieldByname('BOF_Address1').AsString) ;
         fBranchAdd2   :=  trim(FieldByname('BOF_Address2').AsString) ;
         fBranchCity   :=  trim(FieldByname('BOF_City').AsString) ;
         fBranchRegion :=  trim(FieldByname('BOF_Region').AsString) ;
         BRNDisp.Caption :=  'สาขา    : '+trim(FieldByname('BOF_ID').AsString)+' '+trim(FieldByname('BOF_LocalDescr').AsString) ;
         Active := false ;
         Free ;
       end;
end;



Procedure TfrmTransactionProperties.LoadFormat();
var DBForMat : TADOQuery ;
    Rec : Integer ;
    DEf : Integer ;
begin

   ListFormat.Items.Clear ;
   DBForMat := TADOQuery.Create(nil);
     with DBForMat do
       begin
          Connection := frmDataCenter.ADOConnection1 ;
          SQL.Clear ;
          SQL.Text := ' Select * from DBChequeProperties ' ;
          Active := true ;
          Rec := 0 ;
          DEf := 0 ;
           while not eof do
             begin
               ListFormat.Add(trim(FieldByName('FFM_Name').AsString)) ;
               if(FieldByName('FFM_Default').AsBoolean) then
                 begin
                   DEf := Rec ;
                   fFormat := trim(FieldByName('FFM_Name').AsString) ;
                 end;
               Rec := Rec + 1;
               Next
             end;
           Active := false ;
           Free ;
           ListFormat.ItemIndex := DEf ;
           LoadDetailFormat ;
           LoadDetailFormat2(fFormat) ;
       end;
end;

Procedure TfrmTransactionProperties.GetLoadAccount();
begin
 if(DBAccount.Active) then DBAccount.Active := false ;
   with DBAccount do
     begin
       Connection := frmDataCenter.ADOConnection1 ;
       SQL.Clear ;
       SQL.Text := ' Select * from DBAccountMaster '+
                   ' Where ACC_Office	= '+QuotedStr(fBank)+
                   ' and '+
                   ' ACC_Branch	= '+QuotedStr(fBrn) ;
       Active := true ;
     end;
end;

procedure TfrmTransactionProperties.RzGroup1Items0Click(Sender: TObject);
var DBAdd : TADOQuery ;
    fOldPrice : Extended ;
    fOldDisc  : Extended ;
    fDD, FAA  : Extended ;
    SRepare   : String;

    STRD_Amt, STRD_Rev, STRD_Cmms:String;

    STRD_RateType : string;

    edLength : Integer;

begin

    edLength := length(edtAccountID.Text);

    //if RdEmbassy.Checked then

    if RdNormal.Checked then
    begin
       STRD_Amt      := edtAmount.Text;
       STRD_RateType := '1';
    end else
    if RdSpecial.Checked then
    begin
       STRD_Amt      := EdSpecial.Text;
       STRD_RateType := '2';
    end else
    if RdEmbassy.Checked then
    begin
       STRD_Amt      := EdEmbassy.Text;
       STRD_RateType := '3';
    end;



    STRD_Rev  := EdRevenue.Text;
    STRD_Cmms := EdCommission.Text;



  if(trim(edtAccountID.Text) = '') then
    begin
      MessageDlg('ไม่มีเลขที่บัญชี',mtWarning,[mbOk],0) ;
      edtAccountID.SetFocus ; Exit ;
    end;

  if(not ViewAccount.DataController.DataSet.Locate('ACC_ID',Copy(edtAccountID.Text,1,10),[loCaseInsensitive])) then
    begin
      MessageDlg('เลขที่บัญชีไม่ถูกต้อง',mtWarning,[mbOk],0) ;

      //ShowMessage('ed ='+'ds =');
      edtAccountID.SetFocus ; Exit ;
    end;

    if(fNewFormat) then
      begin
        if(Length(trim(edtChequeNO.Text)) < 8 ) then
          begin
           MessageDlg('เลขที่เช็คไม่ถูกต้อง',mtWarning,[mbOk],0) ;
           edtChequeNO.SetFocus ; Exit ;
          end else
          begin
            //================
          end;
      end;

     if(trim(edtBookQty.Text) = '') or (Length(trim(edtBookQty.Text)) = 0) then
       begin
           MessageDlg('จำนวนเช็คไม่ถูกต้อง',mtWarning,[mbOk],0) ;
           edtBookQty.SetFocus ; Exit ;
       end;

     if(fPrice > 0)  then
       begin
         if(fDiscount = 'P') then
           begin
            fPriceItem := (fPrice * StrToIntDef(edtBookQty.Text,0)) - ((((StrToIntDef(edtBookQty.Text,0) * fPrice) * fDiscountValues) / 100)) ;
            fDiscItem  := ((StrToIntDef(edtBookQty.Text,0) * fPrice) * fDiscountValues) / 100 ;

          end else  if(fDiscount = 'A') then
          begin
            fPriceItem := ((fPrice * StrToIntDef(edtBookQty.Text,0)) - (fDiscountValues * StrToIntDef(edtBookQty.Text,0)));
            fDiscItem  := (fDiscountValues * StrToIntDef(edtBookQty.Text,0))  ;

          end else if(fDiscount = 'N') then
          begin
            fPriceItem := fPrice * StrToIntDef(edtBookQty.Text,0) ;
            fDiscItem := 0.00 ;
          end;
       end else
       begin
            fPriceItem := 0.00 ;
            fDiscItem := 0.00 ;
       end;

     if(fFee > 0) then
       begin
         fFeeItem := fFee * StrToIntDef(edtBookQty.Text,0) ;
       end;

       DBAdd := TADOQuery.Create(nil);
         with DBAdd do
           begin
             Connection := frmDataCenter.ADOConnection1 ;
             SQL.Clear ;
{
             SQL.Text := ' if not Exists(Select * from  DBTransaction Where TRN_JobID = '+QuotedStr(fJOBNO)+' ) '+
                         ' begin '+
                         ' Insert Into DBTransaction '+
                         ' ( '+
                         ' TRN_JobID, TRN_JobDescription, TRN_AccountID, TRN_Date, TRN_OfficeID, TRN_BranchID, TRN_UserID, TRN_Status, TRN_AccountName ' +
                         ' ) '+
                         ' Values '+
                         ' ( '+
                          QuotedStr(fJOBNO)+','+
                          QuotedStr(' ')+','+
                          QuotedStr(Copy(edtAccountID.Text,1,10))+','+
                          QuotedStr(FormatDateTime('yyyy-mm-dd',Date))+','+
                          QuotedStr(fBank)+','+
                          QuotedStr(fBrn)+','+
                          QuotedStr(fUserID)+','+
                          QuotedStr('W')+','+
                          QuotedStr(Copy(edtAccountID.Text,12,35))+
                         ' ) '+
                         ' End '+
}
            // if Chk_Repare.Checked then  SRepare := '1' else SRepare := '0';

            SRepare := '1';

             SQL.Text := ' Delete DBTransactionDetails '+
                         ' Where TRD_JobID = '+QuotedStr(fJOBNO)+
                         ' Delete DBRundetails '+
                         ' Where ECD_JobID = '+QuotedStr(fJOBNO)+
                         ' Insert Into DBTransactionDetails '+
                         ' ( '+
                         ' TRD_JobID, TRD_AccountID, TRD_FormatID, TRD_BookQty, TRD_Status, '+
                         ' TRD_UserID, TRD_SerialNo, TRD_Bank, TRD_BRN, TRD_TC, TRD_Amount, '+
                         ' TRD_CreateDate, TRD_AccountName, TRD_Price, TRD_Discount, TRD_Fee,TRD_Repared,  '+
                         ' TRD_Amt, TRD_Rev, TRD_Cmms, TRD_RT' +
                         ' ) '+
                         ' Values '+
                         ' ( '+
                         QuotedStr(fJOBNO)+','+
                         QuotedStr(Copy(edtAccountID.Text,1,10))+','+
                         QuotedStr(fFormat)+','+
                         edtBookQty.Text+','+
                         QuotedStr('W')+','+
                         QuotedStr(fUserID)+','+
                         QuotedStr(trim(edtChequeNO.Text))+','+
                         QuotedStr(fBank)+','+
                         QuotedStr(fBrn)+','+
                         QuotedStr(trim(edtTC.Text))+','+
                         QuotedStr(trim(edtAmount.Text))+','+
                         QuotedStr(FormatDateTime('yyyy-mm-dd',Date))+','+
                         QuotedStr(Copy(edtAccountID.Text,12,35)) +','+
                         //QuotedStr(Copy(edtAccountID.Text,12,edLength)) +','+
                         formatFloat('########.00',fPriceItem)+','+
                         formatFloat('########.00',fDiscItem)+','+
                         formatFloat('########.00',fFeeItem)+','+
                         QuotedStr(SRepare)+','+
                         STRD_Amt+','+
                         STRD_Rev+','+
                         STRD_Cmms+','+
                         STRD_RateType+



                      ' ) ' ;
             //ShowMessage(SQL.Text) ;
             ExecSQL ;
             Free ;
           end;
        ProcessData ;
        fTRResult := trAccept ;
        frmTransactionProperties.Close ;

end;

procedure TfrmTransactionProperties.FormActivate(Sender: TObject);
begin
//=====
   calAmt();

end ;

procedure TfrmTransactionProperties.edtAccountIDChange(Sender: TObject);
begin
 if(trim(edtAccountID.Text) <> '') then
   begin
     DBAccount.Active := false ;
      with DBAccount do
        begin
          Connection := frmDataCenter.ADOConnection1 ;
          SQL.Clear ;
          SQL.Text := ' Select * from DBAccountMaster '+
                      ' Where '+
                      ' ACC_ID like '+QuotedStr('%'+trim(edtAccountID.Text)+'%') +
                      ' or '+
                      ' ACC_Description like '+QuotedStr('%'+trim(edtAccountID.Text)+'%') +
                      ' or '+
                      ' ACC_Address1 like '+QuotedStr('%'+trim(edtAccountID.Text)+'%') +
                      ' or '+
                      ' ACC_Address2 like '+QuotedStr('%'+trim(edtAccountID.Text)+'%') +
                      ' or '+
                      ' ACC_Mobile like '+QuotedStr('%'+trim(edtAccountID.Text)+'%') +
                      ' or '+
                      ' ACC_Tel like '+QuotedStr('%'+trim(edtAccountID.Text)+'%') +
                      ' or '+
                      ' ACC_EMail like '+QuotedStr('%'+trim(edtAccountID.Text)+'%') +
                      ' and '+
                      ' ACC_Office	= '+QuotedStr(fBank)+
                      ' and '+
                      ' ACC_Branch	= '+QuotedStr(fBrn) ;
          Active := true ;            
        end;
   end;
end;

procedure TfrmTransactionProperties.edtAccountIDKeyDown(Sender: TObject;
  var Key: Word; Shift: TShiftState);
begin
  if(Key = VK_RETURN) then
    begin
     if(TRzEdit(Sender).Name = edtAccountID.Name) then
       begin
         fAccountAdd1 := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_Address1').AsString)  ;
         fAccountAdd2 := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_Address2').AsString)  ;

         edtAccountID.Text  := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_ID').AsString)+' '+trim(ViewAccount.DataController.DataSet.FieldByName('ACC_Description').AsString);
         edtAccountID2.Text := fAccountAdd1+' '+fAccountAdd2;
         //edtAccountID.Text := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_ID').AsString)+' '+ViewAccount.DataController.DataSet.FieldByName('ACC_Description').AsString + ' '+fAccountAdd1+' '+fAccountAdd2;
         fAccount     := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_ID').AsString)  ;




         GetLoadAccount ;
       end;
     SelectNext(ActiveControl,true,true);
   end;
end;

Procedure TfrmTransactionProperties.LoadDetailFormat() ;
var DBFor : TADOQuery ;
begin
   DBFor := TADOQuery.Create(nil);
     with DBFor do
       begin
         Connection := frmDataCenter.ADOConnection1 ;
         SQL.Clear ;
         SQL.Text := ' Select * from DBChequeProperties '+
                     ' Where FFM_Name = '+QuotedStr(fFormat) ;
         Active := true ;
         DispFormatName.Caption := ' Format Name : '+trim(FieldByName('FFM_Name').AsString) ;
         DispDocument.Caption :=   ' Document    : '+ IntToStr(FieldByName('FFM_FDQty').AsInteger+FieldByName('FFM_BDQty').AsInteger+FieldByName('FFM_RDQty').AsInteger+FieldByName('FFM_BCQty').AsInteger) ;
         DispPrice.Caption    :=   ' Price       : '+FormatFloat('#,###,###,#00.00',FieldByName('FFM_Price').AsFloat) ;
         fPrice := FieldByName('FFM_Price').AsFloat ;
         fFee   := FieldByName('FFM_FeeValue').AsFloat ;
         if(trim(FieldByName('FFM_Discount').AsString) = 'N')  then  DispDiscount.Caption := ' Discount    : '+' No Discount ' else
         if(trim(FieldByName('FFM_Discount').AsString) = 'A')  then  DispDiscount.Caption := ' Discount    : '+trim(FieldByName('FFM_DiscountValues').AsString)+' บาท' else
         if(trim(FieldByName('FFM_Discount').AsString) = 'P')  then  DispDiscount.Caption := ' Discount    : '+trim(FieldByName('FFM_DiscountValues').AsString)+' %' ;
         fNewFormat := FieldByName('FFM_NewFormat').AsBoolean ;
         fDiscount := trim(FieldByName('FFM_Discount').AsString) ;
         fDiscountValues := StrToFloatDef(FieldByName('FFM_DiscountValues').aSString,0) ;

         Active := false ;
         Free ;
       end;
end ;

procedure TfrmTransactionProperties.ViewAccountDblClick(Sender: TObject);
begin
 //   edtAccountID.OnKeyDown := nil ;
    fAccountAdd1 := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_Address1').AsString)  ;
    fAccountAdd2 := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_Address2').AsString)  ;

    edtAccountID.Text  := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_ID').AsString)+' '+trim(ViewAccount.DataController.DataSet.FieldByName('ACC_Description').AsString) ;
    edtAccountID2.Text := fAccountAdd1+' '+fAccountAdd2;

    fAccount := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_ID').AsString)  ;



    edtChequeNO.SetFocus ;
    GetLoadAccount ;
    Exit ;
//    edtAccountID.HideSelection := true ;
//    edtAccountID.SetFocus ; Exit ;
end;

procedure TfrmTransactionProperties.edtChequeNOEnter(Sender: TObject);
begin
  if(fNewFormat) then edtChequeNO.MaxLength := 8 else edtChequeNO.MaxLength := 7 ;
end;

procedure TfrmTransactionProperties.ListFormatChange(Sender: TObject);
begin
  fFormat := ListFormat.Items.Strings[ListFormat.ItemIndex] ;
  LoadDetailFormat;
  LoadDetailFormat2(fFormat) ;
end;

procedure TfrmTransactionProperties.btnAddClick(Sender: TObject);
var DBAdd : TADOQuery ;
    fOldPrice : Extended ;
    fOldDisc  : Extended ;
    fDD, FAA  : Extended ;
begin

//  ShowMessage(FloatToStr((fPrice * StrToIntDef(edtBookQty.Text,0)) - ((((StrToIntDef(edtBookQty.Text,0) * fPrice) * fDiscountValues) / 100)))) ;
  if(trim(edtAccountID.Text) = '') then
    begin
      MessageDlg('ไม่มีเลขที่บัญชี',mtWarning,[mbOk],0) ;
      edtAccountID.SetFocus ; Exit ;
    end;

  if(not ViewAccount.DataController.DataSet.Locate('ACC_ID',Copy(edtAccountID.Text,1,10),[loCaseInsensitive])) then
    begin
      MessageDlg('เลขที่บัญชีไม่ถูกต้อง',mtWarning,[mbOk],0) ;
      edtAccountID.SetFocus ; Exit ;
    end;

    if(fNewFormat) then
      begin
        if(Length(trim(edtChequeNO.Text)) < 8 ) then
          begin
           MessageDlg('เลขที่เช็คไม่ถูกต้อง',mtWarning,[mbOk],0) ;
           edtChequeNO.SetFocus ; Exit ;
          end else
          begin
            //================
          end;
      end;

     if(trim(edtBookQty.Text) = '') or (Length(trim(edtBookQty.Text)) = 0) then
       begin
           MessageDlg('จำนวนเช็คไม่ถูกต้อง',mtWarning,[mbOk],0) ;
           edtBookQty.SetFocus ; Exit ;
       end;

     if(fPrice > 0)  then
       begin
         if(fDiscount = 'P') then
           begin
            fPriceItem := (fPrice * StrToIntDef(edtBookQty.Text,0)) - ((((StrToIntDef(edtBookQty.Text,0) * fPrice) * fDiscountValues) / 100)) ;
            fDiscItem  := ((StrToIntDef(edtBookQty.Text,0) * fPrice) * fDiscountValues) / 100 ;

          end else  if(fDiscount = 'A') then
          begin
            fPriceItem := ((fPrice * StrToIntDef(edtBookQty.Text,0)) - (fDiscountValues * StrToIntDef(edtBookQty.Text,0)));
            fDiscItem  := (fDiscountValues * StrToIntDef(edtBookQty.Text,0))  ;

          end else if(fDiscount = 'N') then
          begin
            fPriceItem := fPrice * StrToIntDef(edtBookQty.Text,0) ;
            fDiscItem := 0.00 ;
          end;
       end else
       begin
            fPriceItem := 0.00 ;
            fDiscItem := 0.00 ;
       end;

       DBAdd := TADOQuery.Create(nil);
         with DBAdd do
           begin
             Connection := frmDataCenter.ADOConnection1 ;
             SQL.Clear ;
             SQL.Text := ' if not Exists(Select * from  DBTransaction Where TRN_JobID = '+QuotedStr(fJOBNO)+' ) '+
                         ' begin '+
                         ' Insert Into DBTransaction '+
                         ' ( '+
                         ' TRN_JobID, TRN_JobDescription, TRN_AccountID, TRN_Date, TRN_OfficeID, TRN_BranchID, TRN_UserID, TRN_Status, TRN_AccountName ' +
                         ' ) '+
                         ' Values '+
                         ' ( '+
                          QuotedStr(fJOBNO)+','+
                          QuotedStr(' ')+','+
                          QuotedStr(Copy(edtAccountID.Text,1,10))+','+
                          QuotedStr(FormatDateTime('yyyy-mm-dd',Date))+','+
                          QuotedStr(fBank)+','+
                          QuotedStr(fBrn)+','+
                          QuotedStr(fUserID)+','+
                          QuotedStr('W')+','+
                          QuotedStr(Copy(edtAccountID.Text,12,35))+
                         ' ) '+
                         ' End '+

                         ' Insert Into DBTransactionDetails '+
                         ' ( '+
                         ' TRD_JobID, TRD_AccountID, TRD_FormatID, TRD_BookQty, TRD_Status, '+
                         ' TRD_UserID, TRD_SerialNo, TRD_Bank, TRD_BRN, TRD_TC, TRD_Amount, '+
                         ' TRD_CreateDate, TRD_AccountName, TRD_Price, TRD_Discount  '+
                         ' ) '+
                         ' Values '+
                         ' ( '+
                         QuotedStr(fJOBNO)+','+
                         QuotedStr(Copy(edtAccountID.Text,1,10))+','+
                         QuotedStr(fFormat)+','+
                         edtBookQty.Text+','+
                         QuotedStr('W')+','+
                         QuotedStr(fUserID)+','+
                         QuotedStr(trim(edtChequeNO.Text))+','+
                         QuotedStr(fBank)+','+
                         QuotedStr(fBrn)+','+
                         QuotedStr(trim(edtTC.Text))+','+
                         QuotedStr(trim(edtAmount.Text))+','+
                         QuotedStr(FormatDateTime('yyyy-mm-dd',Date))+','+
                         QuotedStr(Copy(edtAccountID.Text,12,35)) +','+
                         formatFloat('########.00',fPriceItem)+','+
                         formatFloat('########.00',fDiscItem)+
                      ' ) ' ;
//             ShowMessage(SQL.Text) ;
             ExecSQL ;
             Free ;
           end;

//          edtTTLAmount.Text := FormatFloat('#,###,###,###,###.00', CalTotalPrices) ;
//          edtDispCount.Text := FormatFloat('#,###,###,###,###.00', CalTotalDisc) ;
//          LoadTR ;
//          fOldPrice := StrToFloatDef(edtTTLAmount.Text,0) ;
//          fOldPrice := fOldPrice +

end;

Function TfrmTransactionProperties.CalTotalPrices() : Extended;
var DBPR : TADOQuery ;
begin
   DBPR := TADOQuery.Create(nil);
     with DBPR do
       begin
         Connection := frmDataCenter.ADOConnection1 ;
         SQL.Clear ;
         SQL.Text := ' Select sum(TRD_Price) as SumPR from DBTransactionDetails '+
                     ' Where TRD_JobID = '+QuotedStr(fJOBNO) ;
         Active := true ;

         CalTotalPrices := FieldByName('SumPR').AsFloat ;
         Active := false ;
         Free ;
       end;
end;

Function TfrmTransactionProperties.CalTotalDisc() : Extended ;
var DBPR : TADOQuery ;
begin
   DBPR := TADOQuery.Create(nil);
     with DBPR do
       begin
         Connection := frmDataCenter.ADOConnection1 ;
         SQL.Clear ;
         SQL.Text := ' Select sum(TRD_Discount) as SumPR from DBTransactionDetails '+
                     ' Where TRD_JobID = '+QuotedStr(fJOBNO) ;
         Active := true ;

         CalTotalDisc := FieldByName('SumPR').AsFloat ;
         Active := false ;
         Free ;
       end;
end;

procedure TfrmTransactionProperties.edtBookQtyKeyPress(Sender: TObject;
  var Key: Char);
begin
  if not (Key in [#48..#57,#13,#08,#127]) then Key := #0 ;
end;

procedure TfrmTransactionProperties.edtAccountIDExit(Sender: TObject);
begin
  GetLoadAccount ;
end;

procedure TfrmTransactionProperties.edtAccountIDEnter(Sender: TObject);
begin
//  edtAccountID.OnKeyDown := edtAccountIDKeyDown ;
end;

procedure TfrmTransactionProperties.edtBookQtyChange(Sender: TObject);
begin
  if(trim(TRzEdit(Sender).Text) <> '') then
    begin
       calAmt;
    end;
end;

procedure TfrmTransactionProperties.edtBookQtyExit(Sender: TObject);
begin
{
     if(fPrice > 0)  then
       begin
         if(fDiscount = 'P') then
           begin
            fPriceItem := (fPrice * StrToIntDef(edtBookQty.Text,0)) - ((((StrToIntDef(edtBookQty.Text,0) * fPrice) * fDiscountValues) / 100)) ;
            fDiscItem  := ((StrToIntDef(edtBookQty.Text,0) * fPrice) * fDiscountValues) / 100 ;
            edtTTLAmount.Text := FloatToStr(StrToFloatDef(edtTTLAmount.Text,0) + fPriceItem )  ;
            edtDispCount.Text := FloatToStr(StrToFloatDef(edtDispCount.Text,0) + fDiscItem )  ;
          end;
       end;
       }
end;

procedure TfrmTransactionProperties.btnDelClick(Sender: TObject);
begin
  if(MessageDlg('ต้องการลบรายการ',mtConfirmation,[mbYes,mbNo],0) = mrYes) then
    begin
//      ViewTR1.DataController.DataSet.Delete ;
//      edtTTLAmount.Text := FormatFloat('#,###,###,###,###.00', CalTotalPrices) ;
//      edtDispCount.Text := FormatFloat('#,###,###,###,###.00', CalTotalDisc) ;
    end;
end;

procedure TfrmTransactionProperties.ViewTR1DblClick(Sender: TObject);
begin
{
  edtAccountID.Text := trim(ViewTR1.DataController.DataSet.FieldByname('TRD_AccountID').AsString)+' '+trim(ViewTR1.DataController.DataSet.FieldByname('TRD_AccountName').AsString) ;
  fAccount := trim(ViewTR1.DataController.DataSet.FieldByname('TRD_AccountID').AsString) ;
  ListFormat.ItemIndex := ListFormat.Items.IndexOf(trim(ViewTR1.DataController.DataSet.FieldByname('TRD_FormatID').AsString)) ;
  edtChequeNO.Text := trim(ViewTR1.DataController.DataSet.FieldByname('TRD_SerialNo').AsString) ;
  edtBookQty.Text := trim(ViewTR1.DataController.DataSet.FieldByname('TRD_BookQty').AsString) ;
  edtTC.Text := trim(ViewTR1.DataController.DataSet.FieldByname('TRD_TC').AsString) ;
  edtAmount.Text := trim(ViewTR1.DataController.DataSet.FieldByname('TRD_Amount').AsString) ;
 }
end;

procedure TfrmTransactionProperties.RzGroup1Items1Click(Sender: TObject);
begin
  fTRResult := trCancel ;
  frmTransactionProperties.Close ;

end;



procedure TfrmTransactionProperties.FormClose(Sender: TObject;
  var Action: TCloseAction);
begin
  Action := caFree ;
end;


Procedure TfrmTransactionProperties.ProcessData();
begin
  if(fNewFormat) then CreateNewFormat() else CreateCurrentFormat() ;
end;

//Procedure TfrmTransactionProperties.CreateNewFormat() ;
Procedure TfrmTransactionProperties.CreateCurrentFormat();
var DocTotal : Integer ;
    MICRData : WideString ;
    Rec,Rec1, Rec2, Rec3 : Integer ;
    FDQty,BDQty,RDQty,BCQty  : Integer ;
    DBDetail : TADOQuery ;
    MICR2 : array[0..64] of String ;
    StPosi : Integer ;
    TempAMT : String ;
    LastNi : Integer ;
    TempCHQ : String ;
    CheckNext : Integer ;
    TempSP : String ;

    PrintL1H1F1 : WideString ;
    printL2H1F1 : WideString ;
    PrintL3H1F1 : WideString ;
    printL4H1F1 : WideString ;

    PrintL1H2F1 : WideString ;
    printL2H2F1 : WideString ;
    PrintL3H2F1 : WideString ;
    printL4H2F1 : WideString ;

    PrintL1H1F2 : WideString ;
    printL2H1F2 : WideString ;
    PrintL3H1F2 : WideString ;
    printL4H1F2 : WideString ;

    PrintL1H2F2 : WideString ;
    printL2H2F2 : WideString ;
    PrintL3H2F2 : WideString ;
    printL4H2F2 : WideString ;


    APrintL1H1 : array of String ;
    AprintL2H1 : array of String ;
    APrintL3H1 : array of String ;
    AprintL4H1 : array of String ;

    APrintL1H2 : array of String ;
    AprintL2H2 : array of String ;
    APrintL3H2 : array of String ;
    AprintL4H2 : array of String ;

    RunDoc : Integer ;
    CheckStart : Integer ;
    fDigitCode : String ;

    fDigitSerial : String ;
    fDigitBank : String ;
    fDigitBRN : String ;
    fDigitAccount : String ;

    TCPos : Integer;

    SCheqEnd:String;

    SBookQty : Integer;

begin
    fAccountAdd1 := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_Address1').AsString)  ;
    fAccountAdd2 := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_Address2').AsString)  ;


    MICRData := '                                                                 ' ;
    DocTotal := 0;
    if(fFDDocUsed) then  DocTotal := DocTotal + fFDDocQty ;
    if(fBDDocUsed) then  DocTotal := DocTotal + (fBDDocQty) ;
    if(fRDDocUsed) then  DocTotal := DocTotal + fRDDocQty ;
    if(fBCDocUsed) then  DocTotal := DocTotal + fBCDocQty ;

                             
    GetBankDefault ; GetBRNDefault ;

       SetLength(APrintL1H1,fFDCharNum) ;
       SetLength(AprintL2H1,fFDCharNum) ;
       SetLength(APrintL3H1,fFDCharNum) ;
       SetLength(AprintL4H1,fFDCharNum) ;

       SetLength(APrintL1H2,fFDCharNum) ;
       SetLength(AprintL2H2,fFDCharNum) ;
       SetLength(APrintL3H2,fFDCharNum) ;
       SetLength(AprintL4H2,fFDCharNum) ;
       DocTotal := 0;
       if(fFDDocUsed) then  DocTotal := DocTotal + fFDDocQty ;
       if(fBDDocUsed) then  DocTotal := DocTotal + (fBDDocQty) ;
       if(fRDDocUsed) then  DocTotal := DocTotal + fRDDocQty ;
       if(fBCDocUsed) then  DocTotal := DocTotal + fBCDocQty ;
       FDQty := fFDDocStRun+(fFDDocQty-1) ;
       //BDQty := fBDDocStRun+(fBDDocQty-1) ;
       BDQty := fBDDocStRun+(fBDDocQty-1) ;
       RDQty := fRDDocStRun+(fRDDocQty-1) ;
       BCQty := fBCDocStRun+(fBCDocQty-1) ;

       SBookQty := strtoint(edtBookQty.Text);

       suiProgressBar1.Max := DocTotal * StrToIntDef(trim(edtBookQty.Text),0) ;
       CheckStart := StrToIntDef(trim(edtChequeNO.Text),0) ;
       CheckNext := StrToIntDef(trim(edtChequeNO.Text),0)  ;

       //SCheqEnd := FormatFloat('0000000',CheckStart+(FbDDocQty-2));
        SCheqEnd := FormatFloat('0000000',CheckStart+((fBDDocQty)*SBookQty)-1);

  for RunDoc := 1 to StrToIntDef(trim(edtBookQty.Text),0)  do
   begin
//    DocTotal := 0;
        for REC := 0 to 64 do
      begin
        MICR2[Rec] := ' ' ;
      end;



      MICRData := '' ;
     CheckStart := CheckNext ;
//    Showmessage(IntTostr(Length(MICRData))) ;
      for REC := 1 to DocTotal do
        begin
          if( REC in [fFDDocStRun..FDQty]) and fFDDocUsed then
            begin

//               LastNi :=

               {if(fFDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('00000000',CheckStart) ;
                  StPosi := 64 - (fFDEStubChequeNoPOS-1);
                  MICR2[StPosi] := Copy(TempCHQ,8,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-7] := Copy(TempCHQ,1,1) ;


                  if(fFDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-7] :=  fFDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fFDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('00000000',CheckStart) ;
                  StPosi := 64-(fFDEChequeNoPOS-1) ;

                  MICR2[StPosi] := Copy(TempCHQ,8,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-7] := Copy(TempCHQ,1,1) ;

                  if(fFDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fFDESBChequeNo ;

                    end else
                    begin

                    end;
                 end; }

                 //============================





                 if(fFDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckStart) ;
                  StPosi := 64 - (fFDEStubChequeNoPOS-1);
                  //StPosi := 64 - (fFDEStubChequeNoPOS);
                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;


                  if(fFDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-7] :=  fFDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fFDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckStart) ;
                  StPosi := 64-(fFDEChequeNoPOS-1) ;


                  //StPosi := 64-(fFDEChequeNoPOS) ;

                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;

                  if(fFDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fFDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;
                 //============================


               if(fFDEBankID = 1) then
                 begin
                  StPosi := 64-(fFDEBankIDPOS-1) ;
                  //StPosi := 64-(fFDEBankIDPOS) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBank),1,1) ;

                  if(fFDESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fFDESBBankID ;

                    end else
                    begin

                    end;
                 end;



               if(fFDEBRNID = 1) then
                 begin
                  StPosi := 64- (fFDEBRNIDPOS-1) ;
                  //StPosi := 64- (fFDEBRNIDPOS) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),1,1) ;

                  if(fFDESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fFDESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fFDEAccountID = 1) then
                 begin
                  StPosi := 64-(fFDEAccountIDPOS-1) ;
                  //StPosi := 64-(fFDEAccountIDPOS) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fFDESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fFDESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fFDETC = 1) then
                 begin

                  StPosi := 64-(fFDETCPOS-1) ;
                  //StPosi := 64-(fFDETCPOS) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fFDESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fFDESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fFDEAmount = 1) then
                 begin
                  StPosi := 64- (fFDEAmountPOS-1) ;
                  //StPosi := 64- (fFDEAmountPOS) ;
                     TempAMT := FormatFloat('00000000000',StrToIntdef(edtAmount.Text,0)) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fFDESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fFDESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fFDEChequeEnd = 1) then
                 begin
                  //StPosi := 64- (fFDEChequeEndPOS-1) ;
                  StPosi := 64- (fFDEChequeEndPOS) ;
                      LastNi := CheckStart + (fBDDocQty-1) ;
                      //TempAMT := FormatFloat('00000000',LastNi) ;
                      TempAMT := FormatFloat('0000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        {MICR2[StPosi] := Copy(TempAMT,8,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-7] := Copy(TempAMT,1,1) ; }

                        MICR2[StPosi] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,1,1) ;
                        //MICR2[StPosi-7] := Copy(TempAMT,1,1) ;


                      end;


                  if(fFDESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fFDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;


                for Rec1 := 0 to 64 do
                  begin
                    //MICRData := MICRData + MICR2[Rec1] ;
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;

//                  MICrList.Caption := MICRData ;

//=================  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fFDPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to CheckStart-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Formatfloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        //for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,39))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fFDCharNum))-1 do

                          begin
                           //APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,38)),Rec1+1,1) ;
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fFDCharNum-1) do
                      //for Rec3 := 0 to (fFDCharNum) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;

                     for Rec3 := 1 to fFDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fFDPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        //for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,38))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fFDCharNum))-1 do

                          begin
                           //APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,38)),Rec1+1,1) ;
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                     //for Rec3 := 0 to (fFDCharNum) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fFDPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PACNA') then
                      begin
                      //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        //for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fFDCharNum))-1 do

                          begin
                           //APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fFDPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        //for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fFDCharNum))-1 do

                          begin
                           //APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;





                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fFDPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        //for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fFDCharNum))-1 do

                          begin
                           //APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fFDPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        //for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fFDCharNum))-1 do

                          begin
                           //APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;





                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fFDPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        //for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fFDCharNum))-1 do

                          begin
                           //APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;

                          end;
                      end else
                     if(fFDPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fFDPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        //for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fFDCharNum))-1 do

                          begin
                           //APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;





                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;






                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_FD_P_L1_H1, ECD_FD_P_L2_H1, ECD_FD_P_L3_H1, ECD_FD_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                    QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;

            end ; // else

//==Body==
          if( REC in [fBDDocStRun..BDQty]) and fBDDocUsed then
            begin
            //ShowMessage(inttostr(BDQty));

              for REC1 := 0 to 64 do
                begin
                 MICR2[Rec1] := ' ' ;
                end;

                MICRData := '' ;

               fDigitSerial :=  FormatFloat('0000000',CheckNext) ;

               if(fBDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckNext) ;
                  StPosi := 64 - (fBDEStubChequeNoPOS-1);
                  //MICR2[StPosi] := Copy(TempCHQ,8,1) ;
                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;


                  if(fBDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-7] :=  fBDESBStubChequeNo ;
                       MICR2[StPosi+1] :=  fBDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fBDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckNext) ;
                  StPosi := 64-(fBDEChequeNoPOS-1) ;

                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;
                  //MICR2[StPosi-7] := Copy(TempCHQ,1,1) ;

                  if(fBDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fBDESBChequeNo ;
                     MICR2[StPosi-7] :=  fBDESBChequeNo ;


                    end else
                    begin

                    end;
                 end;

                 fDigitBank := fBank ;

               if(fBDEBankID = 1) then
                 begin
                  StPosi := 64-(fBDEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;

                  if(fBDESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fBDESBBankID ;


                    end else
                    begin

                    end;
                 end;

                 fDigitBRN := fBrn ;

               if(fBDEBRNID = 1) then
                 begin
                  StPosi := 64- (fBDEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;

                  if(fBDESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fBDESBBRNID ;

                    end else
                    begin

                    end;
                 end;

                fDigitAccount := copy(edtAccountID.Text,1,10) ;

                if(fBDEAccountID = 1) then
                 begin
                  StPosi := 64-(fBDEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fBDESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBDESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fBDETC = 1) then
                 begin

                  StPosi := 64-(fBDETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fBDESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBDESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fBDEAmount = 1) then
                 begin
                  StPosi := 64- (fBDEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',StrToIntdef(edtAmount.Text,0)) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fBDESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBDESBAmount ;
                     MICR2[StPosi-11] := fBDESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fBDEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fBDEChequeEndPOS-1) ;
                      LastNi := StrToIntDef(trim(edtChequeNO.Text),0) + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('00000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                  MICR2[StPosi] := Copy(TempAMT,8,1) ;
                  MICR2[StPosi-1] := Copy(TempAMT,7,1) ;
                  MICR2[StPosi-2] := Copy(TempAMT,6,1) ;
                  MICR2[StPosi-3] := Copy(TempAMT,5,1) ;
                  MICR2[StPosi-4] := Copy(TempAMT,4,1) ;
                  MICR2[StPosi-5] := Copy(TempAMT,3,1) ;
                  MICR2[StPosi-6] := Copy(TempAMT,2,1) ;
                  MICR2[StPosi-7] := Copy(TempAMT,1,1) ;
                      end;


                  if(fBDESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;

                 fDigitCode := GetCheeckDigit(fDigitSerial,fDigitBank,fDigitBRN,fDigitAccount) ;
                //===================
                 {MICR2[14] := ';' ;
                 MICR2[15] := copy(fDigitCode,2,1) ;
                 MICR2[16] := copy(fDigitCode,1,1) ; }

                //====================
                 MICR2[13] := ' ' ;
                 MICR2[14] := ' ' ;
                 MICR2[15] := ' ' ;
                 MICR2[16] := ' ' ;
                //====================

                if (EdtTC.Text <> '') then
                begin
                     TCPos := strtoint(EdTC_Pos.Text);
                     StPosi := 64- (TCPos-1) ;
                     MICR2[StPosi] := Copy(edtTC.text,2,1) ;
                     MICR2[StPosi-1] := Copy(edtTC.text,1,1) ;
                end;



                    for Rec1 := 0 to 64 do
                      begin
                        MICRData := MICRData + MICR2[Rec1] ;
                      end;


    //                  MICrList.Caption := MICRData ;


//=================  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBDPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        //for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBDCharNum))-1 do

                          begin
                           //APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================
//                      TempSP := '' ;
//                      PrintL1H1F1 := '' ;





//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;
                        if(TempSP <> '') then PrintL1H1F1 := TempSP + PrintL1H1F1  ;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;
                        TempSP := '' ;

                     for Rec3 := 1 to fBDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBDPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBDCharNum))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;

                         PrintL1H1F2 :=  '' ;
                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBDPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBDCharNum))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBDPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                       for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBDCharNum))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                      PrintL2H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBDPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBDCharNum))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBDPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBDCharNum))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                      PrintL3H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBDPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBDCharNum)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBDPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBDCharNum))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL4H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;



                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_BD_P_L1_H1, ECD_BD_P_L2_H1, ECD_BD_P_L3_H1, ECD_BD_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                     QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;
                CheckNext := CheckNext+ 1 ;

            end  ; //           else
          if( REC in [fRDDocStRun..RDQty]) and fRDDocUsed then
            begin
              for REC1 := 0 to 64 do
                begin
                 MICR2[Rec1] := ' ' ;
                end;

                MICRData := '' ;

               if(fRDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckStart) ;
                  StPosi := 64 - (fRDEStubChequeNoPOS-1);

                  MICR2[StPosi]  := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;


                  if(fRDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-8] :=  fRDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fRDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckStart) ;
                  StPosi := 64-(fRDEChequeNoPOS-1) ;


                  MICR2[StPosi]   := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;


                  if(fRDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fRDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;


               if(fRDEBankID = 1) then
                 begin
                  StPosi := 64-(fRDEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;

                  if(fRDESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fRDESBBankID ;


                    end else
                    begin

                    end;
                 end;



               if(fRDEBRNID = 1) then
                 begin
                  StPosi := 64- (fRDEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;

                  if(fRDESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fRDESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fRDEAccountID = 1) then
                 begin
                  StPosi := 64-(fRDEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fRDESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fRDESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fRDETC = 1) then
                 begin

                  StPosi := 64-(fRDETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fRDESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fRDESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fRDEAmount = 1) then
                 begin
                  StPosi := 64- (fRDEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',CheckStart) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fRDESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fRDESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fRDEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fRDEChequeEndPOS-1) ;
                      LastNi := CheckStart + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('0000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        MICR2[StPosi] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,1,1) ;
                      end;


                  if(fRDESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fRDESBChequeNo ;
                    end else
                    begin

                    end;
                 end;



                for Rec1 := 0 to 64 do
                  begin
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;

//                  MICrList.Caption := MICRData ;


// ==============  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fRDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fRDPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fRDCharNum))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;

                     for Rec3 := 1 to fBDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fRDPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fRDCharNum))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;

                      PrintL1H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fRDPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fRDCharNum))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fRDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fRDPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fRDCharNum))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                      PrintL2H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fRDPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fRDCharNum))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fRDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fRDPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                       for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fRDCharNum))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                        PrintL3H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fRDPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                       for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fRDCharNum))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fRDPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                       for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fRDCharNum))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                        PrintL4H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;



//                     Showmessage(IntTostr(Length(MICRData))) ;
                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_RD_P_L1_H1, ECD_RD_P_L2_H1, ECD_RD_P_L3_H1, ECD_RD_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                     QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;

                      //ShowMessage(inttostr(BDQty));

            end  ; //           else
          if( REC in [fBCDocStRun..BCQty]) and fBCDocUsed then
            begin
               for REC1 := 0 to 64 do
                begin
                 MICR2[Rec1] := ' ' ;
                end;

                MICRData := '' ;

               if(fBCEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',StrToIntDef(trim(edtChequeNO.Text),0)) ;
                  StPosi := 64 - (fBCEStubChequeNoPOS-1);
                  //= Copy(TempCHQ,8,1) ;
                  MICR2[StPosi]  := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;
                  //MICR2[StPosi-7]

                  if(fBCESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-8] :=  fBCESBStubChequeNo ;

                    end ; //else

                 end;


               if(fBCEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('00000000',StrToIntDef(trim(edtChequeNO.Text),0)) ;
                  StPosi := 64-(fBCEChequeNoPOS-1) ;

                  //= Copy(TempCHQ,8,1) ;
                  MICR2[StPosi]  := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;
                  //MICR2[StPosi-7]
                  if(fBCESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fBCESBChequeNo ;

                    end else
                    begin

                    end;
                 end;


               if(fBCEBankID = 1) then
                 begin
                  StPosi := 64-(fBCEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;

                  if(fBCESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fBCESBBankID ;


                    end else
                    begin

                    end;
                 end;



               if(fBCEBRNID = 1) then
                 begin
                  StPosi := 64- (fBCEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;

                  if(fBCESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fBCESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fBCEAccountID = 1) then
                 begin
                  StPosi := 64-(fBCEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fBCESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBCESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fBCETC = 1) then
                 begin

                  StPosi := 64-(fBCETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fBCESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBCESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fBCEAmount = 1) then
                 begin
                  StPosi := 64- (fBCEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',StrToIntdef(edtAmount.Text,0)) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fBCESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBCESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fBCEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fBCEChequeEndPOS-1) ;
                      LastNi := StrToIntDef(trim(edtChequeNO.Text),0) + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('0000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        MICR2[StPosi] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,1,1) ;
                      end;


                  if(fBCESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBCESBChequeNo ;

                    end else
                    begin

                    end;
                 end;



                for Rec1 := 0 to 64 do
                  begin
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;

//                  MICrList.Caption := MICRData ;

//=================  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBCPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBCCharNum))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fBCCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;

                     for Rec3 := 1 to fFDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBCPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                       for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBCCharNum))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;
                        PrintL1H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBCPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBCCharNum))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBCStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fBCCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBCPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                       for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBCCharNum))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL2H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fBCCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBCPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                         for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBCCharNum))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBCStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBCPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                         for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBCCharNum))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL3H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBCPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                         for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBCCharNum))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBCStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBCPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBCCharNum))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL4H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;



                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_BC_P_L1_H1, ECD_BC_P_L2_H1, ECD_BC_P_L3_H1, ECD_BC_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                     QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;


            end;
            suiProgressBar1.StepIt ;

        end;
    end;
    //ShowMessage('TransID= '+fJOBNO+' ' +'DocNM= '+inttostr(fBDDocQty)+' '+'ChkEnd ='+SCheqEnd);
    UpdBDDocQty(fJOBNO,SCheqEnd);
end;

//============
Procedure TfrmTransactionProperties.CreateNewFormat() ;

var DocTotal : Integer ;
    MICRData : WideString ;
    Rec,Rec1, Rec2, Rec3 : Integer ;
    FDQty,BDQty,RDQty,BCQty  : Integer ;
    DBDetail : TADOQuery ;
    MICR2 : array[0..64] of String ;
    StPosi : Integer ;
    TempAMT : String ;
    LastNi : Integer ;
    TempCHQ : String ;
    CheckNext : Integer ;
    TempSP : String ;

    PrintL1H1F1 : WideString ;
    printL2H1F1 : WideString ;
    PrintL3H1F1 : WideString ;
    printL4H1F1 : WideString ;

    PrintL1H2F1 : WideString ;
    printL2H2F1 : WideString ;
    PrintL3H2F1 : WideString ;
    printL4H2F1 : WideString ;

    PrintL1H1F2 : WideString ;
    printL2H1F2 : WideString ;
    PrintL3H1F2 : WideString ;
    printL4H1F2 : WideString ;

    PrintL1H2F2 : WideString ;
    printL2H2F2 : WideString ;
    PrintL3H2F2 : WideString ;
    printL4H2F2 : WideString ;


    APrintL1H1 : array of String ;
    AprintL2H1 : array of String ;
    APrintL3H1 : array of String ;
    AprintL4H1 : array of String ;

    APrintL1H2 : array of String ;
    AprintL2H2 : array of String ;
    APrintL3H2 : array of String ;
    AprintL4H2 : array of String ;

    RunDoc : Integer ;
    CheckStart : Integer ;
    fDigitCode : String ;

    fDigitSerial : String ;
    fDigitBank : String ;
    fDigitBRN : String ;
    fDigitAccount : String ;

    TCPos:Integer;

    SCheqEnd : String;

    SBookQty : Integer;


begin
    fAccountAdd1 := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_Address1').AsString)  ;
    fAccountAdd2 := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_Address2').AsString)  ;

    MICRData := '                                                                 ' ;
    DocTotal := 0;
    if(fFDDocUsed) then  DocTotal := DocTotal + fFDDocQty ;
    if(fBDDocUsed) then  DocTotal := DocTotal + (fBDDocQty) ;
    if(fRDDocUsed) then  DocTotal := DocTotal + fRDDocQty ;
    if(fBCDocUsed) then  DocTotal := DocTotal + fBCDocQty ;


    GetBankDefault ; GetBRNDefault ;

       SetLength(APrintL1H1,fFDCharNum) ;
       SetLength(AprintL2H1,fFDCharNum) ;
       SetLength(APrintL3H1,fFDCharNum) ;
       SetLength(AprintL4H1,fFDCharNum) ;

       SetLength(APrintL1H2,fFDCharNum) ;
       SetLength(AprintL2H2,fFDCharNum) ;
       SetLength(APrintL3H2,fFDCharNum) ;
       SetLength(AprintL4H2,fFDCharNum) ;
       DocTotal := 0;

       if(fFDDocUsed) then  DocTotal := DocTotal + fFDDocQty ;
       if(fBDDocUsed) then  DocTotal := DocTotal + (fBDDocQty) ;
       if(fRDDocUsed) then  DocTotal := DocTotal + fRDDocQty ;
       if(fBCDocUsed) then  DocTotal := DocTotal + fBCDocQty ;

       FDQty := fFDDocStRun+(fFDDocQty-1) ;
       //BDQty := fBDDocStRun+(fBDDocQty-1) ;
       BDQty := fBDDocStRun+(fBDDocQty-1) ;
       RDQty := fRDDocStRun+(fRDDocQty-1) ;
       BCQty := fBCDocStRun+(fBCDocQty-1) ;

       suiProgressBar1.Max := DocTotal * StrToIntDef(trim(edtBookQty.Text),0) ;
       CheckStart := StrToIntDef(trim(edtChequeNO.Text),0) ;
       CheckNext := StrToIntDef(trim(edtChequeNO.Text),0)  ;

       SBookQty := strtoint(edtBookQty.Text);

       //SCheqEnd := FormatFloat('00000000',CheckStart+((FbDDocQty-2)*SBookQty));

       SCheqEnd := FormatFloat('00000000',CheckStart+((fBDDocQty)*SBookQty)-1);

  for RunDoc := 1 to StrToIntDef(trim(edtBookQty.Text),0)  do
   begin
//    DocTotal := 0;
        for REC := 0 to 64 do
      begin
        MICR2[Rec] := ' ' ;
      end;
      MICRData := '' ;
     CheckStart := CheckNext ;
//    Showmessage(IntTostr(Length(MICRData))) ;
      for REC := 1 to DocTotal do
        begin
          if( REC in [fFDDocStRun..FDQty]) and fFDDocUsed then
            begin

//               LastNi :=

               if(fFDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('00000000',CheckStart) ;
                  StPosi := 64 - (fFDEStubChequeNoPOS-1);
                  MICR2[StPosi] := Copy(TempCHQ,8,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-7] := Copy(TempCHQ,1,1) ;


                  if(fFDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-7] :=  fFDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fFDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('00000000',CheckStart) ;
                  StPosi := 64-(fFDEChequeNoPOS-1) ;

                  MICR2[StPosi] := Copy(TempCHQ,8,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-7] := Copy(TempCHQ,1,1) ;

                  if(fFDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fFDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;


               if(fFDEBankID = 1) then
                 begin
                  StPosi := 64-(fFDEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBank),1,1) ;

                  if(fFDESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fFDESBBankID ;

                    end else
                    begin

                    end;
                 end;



               if(fFDEBRNID = 1) then
                 begin
                  StPosi := 64- (fFDEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;
                  MICR2[StPosi-3] := Copy(trim(fBrn),1,1) ;

                  if(fFDESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fFDESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fFDEAccountID = 1) then
                 begin
                  StPosi := 64-(fFDEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fFDESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fFDESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fFDETC = 1) then
                 begin

                  StPosi := 64-(fFDETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fFDESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fFDESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fFDEAmount = 1) then
                 begin
                  StPosi := 64- (fFDEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',StrToIntdef(edtAmount.Text,0)) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fFDESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fFDESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fFDEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fFDEChequeEndPOS-1) ;
                      LastNi := CheckStart + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('00000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        MICR2[StPosi] := Copy(TempAMT,8,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-7] := Copy(TempAMT,1,1) ;
                      end;


                  if(fFDESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fFDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;

                 //== Getdigit
                 fDigitCode := GetCheeckDigit(fDigitSerial,fDigitBank,fDigitBRN,fDigitAccount) ;
                //===================
                 //MICR2[14] := ';' ;

                 //MICR2[14] := ':' ;
                 //MICR2[15] := copy(fDigitCode,2,1) ;
                 //MICR2[16] := copy(fDigitCode,1,1) ;

                 //MICR2[15] := ' ' ;
                 //MICR2[16] := copy(fDigitCode,2,1) ;
                 //MICR2[17] := copy(fDigitCode,1,1) ;

                 //MICR2[13] := ':' ;
                 {MICR2[13] := ':' ;
                 MICR2[14] := copy(fDigitCode,1,1) ;
                 MICR2[15] := copy(fDigitCode,2,1) ;
                 MICR2[16] := ' ' ; }

                 {MICR2[14] := ':' ;
                 MICR2[15] := copy(fDigitCode,1,1) ;
                 MICR2[16] := copy(fDigitCode,2,1) ;
                 MICR2[17] := ' ' ; }

                 MICR2[14] := ' ' ;
                 MICR2[15] := ' ' ;
                 MICR2[16] := ' ' ;
                 MICR2[17] := ' ' ;



                for Rec1 := 0 to 64 do
                  begin
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;

//                  MICrList.Caption := MICRData ;

//=================  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fFDPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to CheckStart-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Formatfloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                    //xxxx New formatxx fFDCharNum
                     if(fFDPL1H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fFDCharNum)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================
                       
                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;

                     for Rec3 := 1 to fFDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fFDPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fFDCharNum)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fFDPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fFDCharNum)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fFDPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fFDCharNum)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;





                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fFDPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fFDCharNum)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fFDPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fFDCharNum)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;





                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fFDPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fFDCharNum)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fFDPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fFDCharNum)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;





                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;






                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_FD_P_L1_H1, ECD_FD_P_L2_H1, ECD_FD_P_L3_H1, ECD_FD_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                    QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;

            end ; // else
//===Body==

          if( REC in [fBDDocStRun..BDQty]) and fBDDocUsed then
            begin

              for REC1 := 0 to 64 do
                begin
                 MICR2[Rec1] := ' ' ;
                end;

                MICRData := '' ;

               fDigitSerial :=  FormatFloat('00000000',CheckNext) ;

               if(fBDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('00000000',CheckNext) ;
                  StPosi := 64 - (fBDEStubChequeNoPOS-1);
                  MICR2[StPosi] := Copy(TempCHQ,8,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-7] := Copy(TempCHQ,1,1) ;


                  if(fBDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-8] :=  fBDESBStubChequeNo ;
                       MICR2[StPosi+1] :=  fBDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fBDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('00000000',CheckNext) ;
                  StPosi := 64-(fBDEChequeNoPOS-1) ;

                  MICR2[StPosi]   := Copy(TempCHQ,8,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-7] := Copy(TempCHQ,1,1) ;

                  if(fBDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fBDESBChequeNo ;
                     MICR2[StPosi-8] :=  fBDESBChequeNo ;


                    end else
                    begin

                    end;
                 end;

                 fDigitBank := fBank ;

               if(fBDEBankID = 1) then
                 begin
                  StPosi := 64-(fBDEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;
                  //=======================
                  MICR2[StPosi-2] := Copy(trim(fBank),1,1) ;
                  //=======================
                  if(fBDESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fBDESBBankID ;


                    end else
                    begin

                    end;
                 end;

                 fDigitBRN := fBrn ;

               if(fBDEBRNID = 1) then
                 begin
                  StPosi := 64- (fBDEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;
                  //=======================
                  MICR2[StPosi-3] := Copy(trim(fBrn),1,1) ;
                  //=======================
                  if(fBDESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fBDESBBRNID ;

                    end else
                    begin

                    end;
                 end;

                fDigitAccount := copy(edtAccountID.Text,1,10) ;

                if(fBDEAccountID = 1) then
                 begin
                  StPosi := 64-(fBDEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fBDESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBDESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fBDETC = 1) then
                 begin

                  StPosi := 64-(fBDETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fBDESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBDESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fBDEAmount = 1) then
                 begin
                  StPosi := 64- (fBDEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',StrToIntdef(edtAmount.Text,0)) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fBDESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBDESBAmount ;
                     MICR2[StPosi-11] := fBDESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fBDEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fBDEChequeEndPOS-1) ;
                      LastNi := StrToIntDef(trim(edtChequeNO.Text),0) + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('00000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                  MICR2[StPosi] := Copy(TempAMT,8,1) ;
                  MICR2[StPosi-1] := Copy(TempAMT,7,1) ;
                  MICR2[StPosi-2] := Copy(TempAMT,6,1) ;
                  MICR2[StPosi-3] := Copy(TempAMT,5,1) ;
                  MICR2[StPosi-4] := Copy(TempAMT,4,1) ;
                  MICR2[StPosi-5] := Copy(TempAMT,3,1) ;
                  MICR2[StPosi-6] := Copy(TempAMT,2,1) ;
                  MICR2[StPosi-7] := Copy(TempAMT,1,1) ;
                      end;


                  if(fBDESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;

                 fDigitCode := GetCheeckDigit(fDigitSerial,fDigitBank,fDigitBRN,fDigitAccount) ;

                 if(fBDEChequeNo = 1) then
                 begin
                    //MICR2[14] := ';' ;
                    //MICR2[15] := copy(fDigitCode,2,1) ;
                    //MICR2[16] := copy(fDigitCode,1,1) ;

                    //MICR2[13] := ';' ;
                    {MICR2[13] := ':' ;
                    MICR2[14] := copy(fDigitCode,1,1) ;
                    MICR2[15] := copy(fDigitCode,2,1) ;
                    MICR2[16] := ' ' ;}

                    MICR2[14] := ':' ;
                    MICR2[15] := copy(fDigitCode,1,1) ;
                    MICR2[16] := copy(fDigitCode,2,1) ;
                    MICR2[17] := ' ' ;

                 end
                 else
                 begin
                    MICR2[13] := ' ' ;
                    MICR2[14] := ' ' ;
                    MICR2[15] := ' ' ;
                    MICR2[16] := ' ' ;
                 end ;

                 if (EdtTC.Text <> '') then
                begin
                     TCPos := strtoint(EdTC_Pos.Text);
                     StPosi := 64- (TCPos-1) ;
                     MICR2[StPosi] := Copy(edtTC.text,2,1) ;
                     MICR2[StPosi-1] := Copy(edtTC.text,1,1) ;
                end;

                // GetCheckDigitxxx

                //MICR2[14] := ';' ;
                //MICR2[15] := copy(fDigitCode,2,1) ;
                //MICR2[16] := copy(fDigitCode,1,1) ;

                {MICR2[13] := ':' ;
                MICR2[14] := copy(fDigitCode,1,1) ;
                MICR2[15] := copy(fDigitCode,2,1) ;
                MICR2[16] := ' ' ;  }

                 MICR2[14] := ':' ;
                 MICR2[15] := copy(fDigitCode,1,1) ;
                 MICR2[16] := copy(fDigitCode,2,1) ;
                 MICR2[17] := ' ' ;
                


                for Rec1 := 0 to 64 do
                  begin
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;


//                  MICrList.Caption := MICRData ;


//=================  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBDPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,fBDCharNum))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Copy(edtAccountID.Text,11,fBDCharNum),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fAccountAdd1,Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================
//                      TempSP := '' ;
//                      PrintL1H1F1 := '' ;



//--- space in L1H1---

//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ; 
                          //PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;
                        if(TempSP <> '') then PrintL1H1F1 := TempSP + PrintL1H1F1  ;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;
                        TempSP := '' ;

                     for Rec3 := 1 to fBDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBDPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBDCharNum)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;

                         PrintL1H1F2 :=  '' ;
                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBDPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBDCharNum)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBDPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBDCharNum)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                      PrintL2H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBDPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBDCharNum)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBDPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBDCharNum)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                      PrintL3H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBDPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBDCharNum)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBDPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBDCharNum)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL4H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;



                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_BD_P_L1_H1, ECD_BD_P_L2_H1, ECD_BD_P_L3_H1, ECD_BD_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                     QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;
                CheckNext := CheckNext+ 1 ;

            end  ; //           else
          if( REC in [fRDDocStRun..RDQty]) and fRDDocUsed then
            begin
              for REC1 := 0 to 64 do
                begin
                 MICR2[Rec1] := ' ' ;
                end;

                MICRData := '' ;

               if(fRDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('00000000',CheckStart) ;
                  StPosi := 64 - (fRDEStubChequeNoPOS-1);
                  MICR2[StPosi] := Copy(TempCHQ,8,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-7] := Copy(TempCHQ,1,1) ;

                  if(fRDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-8] :=  fRDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fRDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('00000000',CheckStart) ;
                  StPosi := 64-(fRDEChequeNoPOS-1) ;

                  MICR2[StPosi] := Copy(TempCHQ,8,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-7] := Copy(TempCHQ,1,1) ;
                  if(fRDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fRDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;


               if(fRDEBankID = 1) then
                 begin
                  StPosi := 64-(fRDEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;

                  if(fRDESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fRDESBBankID ;


                    end else
                    begin

                    end;
                 end;



               if(fRDEBRNID = 1) then
                 begin
                  StPosi := 64- (fRDEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;

                  if(fRDESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fRDESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fRDEAccountID = 1) then
                 begin
                  StPosi := 64-(fRDEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fRDESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fRDESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fRDETC = 1) then
                 begin

                  StPosi := 64-(fRDETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fRDESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fRDESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fRDEAmount = 1) then
                 begin
                  StPosi := 64- (fRDEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',CheckStart) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fRDESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fRDESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fRDEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fRDEChequeEndPOS-1) ;
                      LastNi := CheckStart + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('0000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        MICR2[StPosi] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,1,1) ;
                      end;


                  if(fRDESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fRDESBChequeNo ;
                    end else
                    begin

                    end;
                 end;



                for Rec1 := 0 to 64 do
                  begin
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;

//                  MICrList.Caption := MICRData ;


// ==============  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fRDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fRDPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fRDCharNum)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;

                     for Rec3 := 1 to fBDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fRDPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fRDCharNum)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;

                      PrintL1H1F2 :=  '' ;
                      
                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fRDPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fRDCharNum)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fRDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fRDPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fRDCharNum)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                      PrintL2H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fRDPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fRDCharNum)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fRDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fRDPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fRDCharNum)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                        PrintL3H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fRDPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fRDCharNum)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fRDPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fRDCharNum)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fRDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                        PrintL4H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;



//                     Showmessage(IntTostr(Length(MICRData))) ;
                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_RD_P_L1_H1, ECD_RD_P_L2_H1, ECD_RD_P_L3_H1, ECD_RD_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                     QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;

            end  ; //           else
          if( REC in [fBCDocStRun..BCQty]) and fBCDocUsed then
            begin
               for REC1 := 0 to 64 do
                begin
                 MICR2[Rec1] := ' ' ;
                end;

                MICRData := '' ;

               if(fBCEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('00000000',StrToIntDef(trim(edtChequeNO.Text),0)) ;
                  StPosi := 64 - (fBCEStubChequeNoPOS-1);
                  MICR2[StPosi] := Copy(TempCHQ,8,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-7] := Copy(TempCHQ,1,1) ;

                  if(fBCESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-8] :=  fBCESBStubChequeNo ;

                    end ; //else

                 end;


               if(fBCEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('00000000',StrToIntDef(trim(edtChequeNO.Text),0)) ;
                  StPosi := 64-(fBCEChequeNoPOS-1) ;

                  MICR2[StPosi] := Copy(TempCHQ,8,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-7] := Copy(TempCHQ,1,1) ;

                  if(fBCESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fBCESBChequeNo ;

                    end else
                    begin

                    end;
                 end;


               if(fBCEBankID = 1) then
                 begin
                  StPosi := 64-(fBCEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;

                  if(fBCESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fBCESBBankID ;


                    end else
                    begin

                    end;
                 end;



               if(fBCEBRNID = 1) then
                 begin
                  StPosi := 64- (fBCEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;

                  if(fBCESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fBCESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fBCEAccountID = 1) then
                 begin
                  StPosi := 64-(fBCEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fBCESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBCESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fBCETC = 1) then
                 begin

                  StPosi := 64-(fBCETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fBCESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBCESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fBCEAmount = 1) then
                 begin
                  StPosi := 64- (fBCEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',StrToIntdef(edtAmount.Text,0)) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fBCESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBCESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fBCEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fBCEChequeEndPOS-1) ;
                      LastNi := StrToIntDef(trim(edtChequeNO.Text),0) + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('0000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        MICR2[StPosi] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,1,1) ;
                      end;


                  if(fBCESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBCESBChequeNo ;

                    end else
                    begin

                    end;
                 end;



                for Rec1 := 0 to 64 do
                  begin
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;

//                  MICrList.Caption := MICRData ;

//=================  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBCPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBCCharNum)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================
                       
                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fBCCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;

                     for Rec3 := 1 to fFDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBCPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBCCharNum)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;
                        PrintL1H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBCPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBCCharNum)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBCStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fBCCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBCPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fFDCharNum)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL2H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fBCCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBCPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fFDCharNum)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fFDCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBCStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBCPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBCCharNum)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL3H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBCPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBCCharNum)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBCStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBCPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,fBCCharNum)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,fBCCharNum)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL4H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;



                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_BC_P_L1_H1, ECD_BC_P_L2_H1, ECD_BC_P_L3_H1, ECD_BC_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                     QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;


            end;
            suiProgressBar1.StepIt ;

        end;
    end;
    //CheckStart
    //TempCHQ := FormatFloat('00000000',CheckNext) ;
//aaxx
    //ShowMessage('TransID= '+fJOBNO+' ' +'DocNM= '+inttostr(fBDDocQty)+' '+'ChkEnd ='+SCheqEnd);
    UpdBDDocQty(fJOBNO,SCheqEnd);
end;
//============

procedure TfrmTransactionProperties.UpdBDDocQty(STransID,SDocNm:String);
var
   QrUpd : TADOQuery;
begin
   QrUpd := TADOQuery.Create(self);
   With QrUpd do
   begin
      Connection := frmDataCenter.ADOConnection1;
      Close;
      SQL.Clear;
      SQL.Text := ' Update DBTransactionDetails set TRD_serialEnd = '+ QuotedStr(SDocNm)+
                  ' Where TRD_JobID = ' + QuotedStr(StransID);

      ExecSQL;
   end

end;


Procedure TfrmTransactionProperties.CreateCurrentFormatxx() ;
var DocTotal : Integer ;
    MICRData : WideString ;
    Rec,Rec1, Rec2, Rec3 : Integer ;
    FDQty,BDQty,RDQty,BCQty  : Integer ;
    DBDetail : TADOQuery ;
    MICR2 : array[0..64] of String ;
    StPosi : Integer ;
    TempAMT : String ;
    LastNi : Integer ;
    TempCHQ : String ;
    CheckNext : Integer ;
    TempSP : String ;

    PrintL1H1F1 : WideString ;
    printL2H1F1 : WideString ;
    PrintL3H1F1 : WideString ;
    printL4H1F1 : WideString ;

    PrintL1H2F1 : WideString ;
    printL2H2F1 : WideString ;
    PrintL3H2F1 : WideString ;
    printL4H2F1 : WideString ;

    PrintL1H1F2 : WideString ;
    printL2H1F2 : WideString ;
    PrintL3H1F2 : WideString ;
    printL4H1F2 : WideString ;

    PrintL1H2F2 : WideString ;
    printL2H2F2 : WideString ;
    PrintL3H2F2 : WideString ;
    printL4H2F2 : WideString ;


    APrintL1H1 : array of String ;
    AprintL2H1 : array of String ;
    APrintL3H1 : array of String ;
    AprintL4H1 : array of String ;

    APrintL1H2 : array of String ;
    AprintL2H2 : array of String ;
    APrintL3H2 : array of String ;
    AprintL4H2 : array of String ;

    RunDoc : Integer ;
    CheckStart : Integer ;


begin

    GetBankDefault ; GetBRNDefault ;

       SetLength(APrintL1H1,fFDCharNum) ;
       SetLength(AprintL2H1,fFDCharNum) ;
       SetLength(APrintL3H1,fFDCharNum) ;
       SetLength(AprintL4H1,fFDCharNum) ;

       SetLength(APrintL1H2,fFDCharNum) ;
       SetLength(AprintL2H2,fFDCharNum) ;
       SetLength(APrintL3H2,fFDCharNum) ;
       SetLength(AprintL4H2,fFDCharNum) ;
       DocTotal := 0;
       if(fFDDocUsed) then  DocTotal := DocTotal + fFDDocQty ;
       if(fBDDocUsed) then  DocTotal := DocTotal + fBDDocQty ;
       if(fRDDocUsed) then  DocTotal := DocTotal + fRDDocQty ;
       if(fBCDocUsed) then  DocTotal := DocTotal + fBCDocQty ;
       FDQty := fFDDocStRun+(fFDDocQty-1) ;
       BDQty := fBDDocStRun+(fBDDocQty-1) ;
       RDQty := fRDDocStRun+(fRDDocQty-1) ;
       BCQty := fBCDocStRun+(fBCDocQty-1) ;

       suiProgressBar1.Max := DocTotal * StrToIntDef(trim(edtBookQty.Text),0) ;
       CheckStart := StrToIntDef(trim(edtChequeNO.Text),0) ;
       CheckNext := StrToIntDef(trim(edtChequeNO.Text),0)  ;

  for RunDoc := 1 to StrToIntDef(trim(edtBookQty.Text),0)  do
   begin
//    DocTotal := 0;
        for REC := 0 to 64 do
      begin
        MICR2[Rec] := ' ' ;
      end;
      MICRData := '' ;
     CheckStart := CheckNext ;
//    Showmessage(IntTostr(Length(MICRData))) ;
      for REC := 1 to DocTotal do
        begin
          if( REC in [fFDDocStRun..FDQty]) and fFDDocUsed then
            begin

//               LastNi :=

               if(fFDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckStart) ;
                  StPosi := 64 - (fFDEStubChequeNoPOS-1);
                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;


                  if(fFDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-7] :=  fFDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fFDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckStart) ;
                  StPosi := 64-(fFDEChequeNoPOS-1) ;

                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;

                  if(fFDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fFDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;


               if(fFDEBankID = 1) then
                 begin
                  StPosi := 64-(fFDEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;

                  if(fFDESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fFDESBBankID ;


                    end else
                    begin

                    end;
                 end;



               if(fFDEBRNID = 1) then
                 begin
                  StPosi := 64- (fFDEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;

                  if(fFDESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fFDESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fFDEAccountID = 1) then
                 begin
                  StPosi := 64-(fFDEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fFDESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fFDESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fFDETC = 1) then
                 begin

                  StPosi := 64-(fFDETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fFDESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fFDESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fFDEAmount = 1) then
                 begin
                  StPosi := 64- (fFDEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',StrToIntdef(edtAmount.Text,0)) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fFDESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fFDESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fFDEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fFDEChequeEndPOS-1) ;
                      LastNi := CheckStart + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('0000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        MICR2[StPosi] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,1,1) ;
                      end;


                  if(fFDESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fFDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;

                 

                for Rec1 := 0 to 64 do
                  begin
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;

//                  MICrList.Caption := MICRData ;

//=================  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fFDPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to CheckStart-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Formatfloat('0000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================
                       
                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;

                     for Rec3 := 1 to fFDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fFDPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckStart))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(formatFloat('0000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fFDPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckStart))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('0000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fFDPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckStart))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('0000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;





                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fFDPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckStart))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('0000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fFDPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckStart))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('0000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;





                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fFDPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckStart))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('0000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fFDPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckStart))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('0000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;





                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;






                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_FD_P_L1_H1, ECD_FD_P_L2_H1, ECD_FD_P_L3_H1, ECD_FD_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                    QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;

            end ; // else


          if( REC in [fBDDocStRun..BDQty]) and fBDDocUsed then
            begin

              for REC1 := 0 to 64 do
                begin
                 MICR2[Rec1] := ' ' ;
                end;

                MICRData := '' ;

               if(fBDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckNext) ;
                  StPosi := 64 - (fBDEStubChequeNoPOS-1);
                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;


                  if(fBDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-7] :=  fBDESBStubChequeNo ;
                       MICR2[StPosi+1] :=  fBDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fBDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckNext) ;
                  StPosi := 64-(fBDEChequeNoPOS-1) ;

                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;

                  if(fBDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fBDESBChequeNo ;
                     MICR2[StPosi-7] :=  fBDESBChequeNo ;


                    end else
                    begin

                    end;
                 end;


               if(fBDEBankID = 1) then
                 begin
                  StPosi := 64-(fBDEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;

                  if(fBDESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fBDESBBankID ;


                    end else
                    begin

                    end;
                 end;



               if(fBDEBRNID = 1) then
                 begin
                  StPosi := 64- (fBDEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;

                  if(fBDESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fBDESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fBDEAccountID = 1) then
                 begin
                  StPosi := 64-(fBDEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fBDESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBDESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fBDETC = 1) then
                 begin

                  StPosi := 64-(fBDETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fBDESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBDESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fBDEAmount = 1) then
                 begin
                  StPosi := 64- (fBDEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',StrToIntdef(edtAmount.Text,0)) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fBDESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBDESBAmount ;
                     MICR2[StPosi-11] := fBDESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fBDEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fBDEChequeEndPOS-1) ;
                      LastNi := StrToIntDef(trim(edtChequeNO.Text),0) + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('0000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        MICR2[StPosi] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,1,1) ;
                      end;


                  if(fBDESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;



                for Rec1 := 0 to 64 do
                  begin
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;

//                  MICrList.Caption := MICRData ;


//=================  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBDPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckNext))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(formatFloat('0000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================
//                      TempSP := '' ;
//                      PrintL1H1F1 := '' ;





//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;
                        if(TempSP <> '') then PrintL1H1F1 := TempSP + PrintL1H1F1  ;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;
                        TempSP := '' ;

                     for Rec3 := 1 to fBDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBDPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckNext))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(formatFloat('0000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;

                         PrintL1H1F2 :=  '' ;
                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBDPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckNext))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('0000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBDPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckNext))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('0000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                      PrintL2H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBDPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckNext))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('0000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBDPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckNext))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('0000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                      PrintL3H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBDPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckNext))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('0000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBDPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('0000000',CheckNext))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('0000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL4H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;


                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_BD_P_L1_H1, ECD_BD_P_L2_H1, ECD_BD_P_L3_H1, ECD_BD_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                     QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;
                CheckNext := CheckNext+ 1 ;

            end  ; //           else
          if( REC in [fRDDocStRun..RDQty]) and fRDDocUsed then
            begin
              for REC1 := 0 to 64 do
                begin
                 MICR2[Rec1] := ' ' ;
                end;

                MICRData := '' ;

               if(fRDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckStart) ;
                  StPosi := 64 - (fRDEStubChequeNoPOS-1);
                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;


                  if(fRDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-7] :=  fRDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fRDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckStart) ;
                  StPosi := 64-(fRDEChequeNoPOS-1) ;

                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;

                  if(fRDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fRDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;


               if(fRDEBankID = 1) then
                 begin
                  StPosi := 64-(fRDEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;

                  if(fRDESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fRDESBBankID ;


                    end else
                    begin

                    end;
                 end;



               if(fRDEBRNID = 1) then
                 begin
                  StPosi := 64- (fRDEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;

                  if(fRDESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fRDESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fRDEAccountID = 1) then
                 begin
                  StPosi := 64-(fRDEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fRDESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fRDESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fRDETC = 1) then
                 begin

                  StPosi := 64-(fRDETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fRDESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fRDESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fRDEAmount = 1) then
                 begin
                  StPosi := 64- (fRDEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',CheckStart) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fRDESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fRDESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fRDEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fRDEChequeEndPOS-1) ;
                      LastNi := CheckStart + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('0000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        MICR2[StPosi] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,1,1) ;
                      end;


                  if(fRDESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fRDESBChequeNo ;
                    end else
                    begin

                    end;
                 end;



                for Rec1 := 0 to 64 do
                  begin
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;

//                  MICrList.Caption := MICRData ;


// ==============  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fRDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fRDPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;

                     for Rec3 := 1 to fBDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fRDPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;

                      PrintL1H1F2 :=  '' ;
                      
                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fRDPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fRDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fRDPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                      PrintL2H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fRDPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fRDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fRDPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                        PrintL3H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fRDPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fRDPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                        PrintL4H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;



//                     Showmessage(IntTostr(Length(MICRData))) ;
                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_RD_P_L1_H1, ECD_RD_P_L2_H1, ECD_RD_P_L3_H1, ECD_RD_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                     QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;

            end  ; //           else
          if( REC in [fBCDocStRun..BCQty]) and fBCDocUsed then
            begin
               for REC1 := 0 to 64 do
                begin
                 MICR2[Rec1] := ' ' ;
                end;

                MICRData := '' ;

               if(fBCEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',StrToIntDef(trim(edtChequeNO.Text),0)) ;
                  StPosi := 64 - (fBCEStubChequeNoPOS-1);
                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;


                  if(fBCESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-7] :=  fBCESBStubChequeNo ;

                    end ; //else

                 end;


               if(fBCEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',StrToIntDef(trim(edtChequeNO.Text),0)) ;
                  StPosi := 64-(fBCEChequeNoPOS-1) ;

                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;

                  if(fBCESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fBCESBChequeNo ;

                    end else
                    begin

                    end;
                 end;


               if(fBCEBankID = 1) then
                 begin
                  StPosi := 64-(fBCEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;

                  if(fBCESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fBCESBBankID ;


                    end else
                    begin

                    end;
                 end;



               if(fBCEBRNID = 1) then
                 begin
                  StPosi := 64- (fBCEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;

                  if(fBCESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fBCESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fBCEAccountID = 1) then
                 begin
                  StPosi := 64-(fBCEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fBCESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBCESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fBCETC = 1) then
                 begin

                  StPosi := 64-(fBCETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fBCESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBCESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fBCEAmount = 1) then
                 begin
                  StPosi := 64- (fBCEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',StrToIntdef(edtAmount.Text,0)) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fBCESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBCESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fBCEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fBCEChequeEndPOS-1) ;
                      LastNi := StrToIntDef(trim(edtChequeNO.Text),0) + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('0000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        MICR2[StPosi] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,1,1) ;
                      end;


                  if(fBCESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBCESBChequeNo ;

                    end else
                    begin

                    end;
                 end;



                for Rec1 := 0 to 64 do
                  begin
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;

//                  MICrList.Caption := MICRData ;

//=================  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBCPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================
                       
                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fBCCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;

                     for Rec3 := 1 to fFDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBCPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;
                        PrintL1H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBCPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBCStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fBCCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBCPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL2H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fBCCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBCPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBCStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBCPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL3H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBCPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBCStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBCPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PACNA') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL4H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;



                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_BC_P_L1_H1, ECD_BC_P_L2_H1, ECD_BC_P_L3_H1, ECD_BC_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                     QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;


            end;
            suiProgressBar1.StepIt ;

        end;
    end;

end;

Function TfrmTransactionProperties.DoStang(inData : String; HaveDot : Boolean) : String;
var Stang : String ;
    Bath : String ;
    Rec :Integer ;
begin
    if(HaveDot) then
      begin
         Rec := Length(trim(inData)) ;
         Stang := copy(inData,Rec-1,2) ;
         Bath  := Copy(inData,1,Rec-3) ;
         DoStang := Bath+Stang ;
      end else
      begin
         Rec := Length(trim(inData)) ;
         Stang := copy(inData,Rec-1,2) ;
         Bath  := Copy(inData,1,Rec-2) ;
         DoStang := Bath+'.'+Stang ;
      end;
end;

Function TfrmTransactionProperties.GetCheeckDigit(finChqSerail : String; finBankID : String; finBRNID : String; finAccountID : String) : String ;
var Rec : Integer ;
    WeigthNo : Integer ;
    tempString : String ;
    TempInt : Integer ;
    SumInt : Integer ;
    CutStrStart : String ;

begin

      WeigthNo := 25 ;
      SumInt := 0 ;
      CutStrStart := finChqSerail+finBankID+finBRNID+finAccountID ;

      for Rec := 1 to Length(CutStrStart) do
        begin
          tempString := Copy(CutStrStart,Rec,1) ;
          TempInt := StrtoIntdef(tempString,-1) ;
          if(TempInt <> -1) then
            begin
              SumInt := SumInt + (TempInt * WeigthNo) ;
              WeigthNo := WeigthNo - 1 ;
            end;
          if(WeigthNo = 0) Then Break ;
        end;
         SumInt := SumInt mod 97 ;
         if(SumInt <= 0) then GetCheeckDigit := formatfloat('00',SumInt) else
           begin
             SumInt := 97 - SumInt ;
             GetCheeckDigit := formatfloat('00',SumInt);
//             GetCheeckDigit := drSucess ;
           end;


end;

procedure TfrmTransactionProperties.RzButton1Click(Sender: TObject);
begin
   ProcessData();
end;

procedure TfrmTransactionProperties.Chk_RepareClick(Sender: TObject);
begin
   if Chk_Repare.Checked then
   begin
      RzLabel3.Enabled := true;
      edtTC.Enabled    := true;
      Label1.Enabled   := true;
      EdTC_Pos.Enabled := true;
   end
   else
   begin
      RzLabel3.Enabled := false;
      edtTC.Enabled    := false;
      Label1.Enabled   := false;
      EdTC_Pos.Enabled := false;
   end;
end;

procedure TfrmTransactionProperties.RdNormalClick(Sender: TObject);
begin
   calAmt();
end;

procedure TfrmTransactionProperties.RdSpecialClick(Sender: TObject);
begin
    calAmt();
end;

procedure TfrmTransactionProperties.RdEmbassyClick(Sender: TObject);
begin
   calAmt();
end;

procedure TfrmTransactionProperties.calAmt();
var BookQty:integer;
    Amnt :integer;
    Rev  :integer;
    Cmm  :integer;
begin
   if RdEmbassy.Checked then
   begin
      BookQty := strtoint(edtBookQty.Text);

      {Amnt := BookQty*300;
      Rev  := BookQty*0;
      Cmm  := BookQty*300;}

      Amnt := BookQty*0;
      Rev  := BookQty*0;
      Cmm  := BookQty*0;

      EdEmbassy.Text := inttostr(Amnt);
      EdRevenue.Text := inttostr(Rev);
      EdCommission.Text := inttostr(Cmm);


      edtAmount.Enabled    := false;
      EdSpecial.Enabled    := false;
      EdEmbassy.Enabled    := true;
      EdRevenue.Enabled    := false;
      EdCommission.Enabled := true;
   end else

   if RdSpecial.Checked then
   begin
      BookQty := strtoint(edtBookQty.Text);

      {Amnt := BookQty*250;
      Rev  := BookQty*75;
      Cmm  := BookQty*175;}

      Amnt := BookQty*0;
      Rev  := BookQty*0;
      Cmm  := BookQty*0;

      EdSpecial.Text := inttostr(Amnt);
      EdRevenue.Text := inttostr(Rev);
      EdCommission.Text := inttostr(Cmm);


      edtAmount.Enabled    := false;
      EdSpecial.Enabled    := true;
      EdEmbassy.Enabled    := false;
      EdRevenue.Enabled    := true;
      EdCommission.Enabled := true;
   end else

   if RdNormal.Checked then
   begin
      BookQty := strtoint(edtBookQty.Text);

      {Amnt := BookQty*375;
      Rev  := BookQty*75;
      Cmm  := BookQty*300; }

      Amnt := BookQty*0;
      Rev  := BookQty*0;
      Cmm  := BookQty*0;

      edtAmount.Text := inttostr(Amnt);
      EdRevenue.Text := inttostr(Rev);
      EdCommission.Text := inttostr(Cmm);

      edtAmount.Enabled    := true;
      EdSpecial.Enabled    := false;
      EdEmbassy.Enabled    := false;
      EdRevenue.Enabled    := true;
      EdCommission.Enabled := true;

   end;


end;

//++++++++++
Procedure TfrmTransactionProperties.CreateCurrentFormatxx2();
var DocTotal : Integer ;
    MICRData : WideString ;
    Rec,Rec1, Rec2, Rec3 : Integer ;
    FDQty,BDQty,RDQty,BCQty  : Integer ;
    DBDetail : TADOQuery ;
    MICR2 : array[0..64] of String ;
    StPosi : Integer ;
    TempAMT : String ;
    LastNi : Integer ;
    TempCHQ : String ;
    CheckNext : Integer ;
    TempSP : String ;

    PrintL1H1F1 : WideString ;
    printL2H1F1 : WideString ;
    PrintL3H1F1 : WideString ;
    printL4H1F1 : WideString ;

    PrintL1H2F1 : WideString ;
    printL2H2F1 : WideString ;
    PrintL3H2F1 : WideString ;
    printL4H2F1 : WideString ;

    PrintL1H1F2 : WideString ;
    printL2H1F2 : WideString ;
    PrintL3H1F2 : WideString ;
    printL4H1F2 : WideString ;

    PrintL1H2F2 : WideString ;
    printL2H2F2 : WideString ;
    PrintL3H2F2 : WideString ;
    printL4H2F2 : WideString ;


    APrintL1H1 : array of String ;
    AprintL2H1 : array of String ;
    APrintL3H1 : array of String ;
    AprintL4H1 : array of String ;

    APrintL1H2 : array of String ;
    AprintL2H2 : array of String ;
    APrintL3H2 : array of String ;
    AprintL4H2 : array of String ;

    RunDoc : Integer ;
    CheckStart : Integer ;
    fDigitCode : String ;

    fDigitSerial : String ;
    fDigitBank : String ;
    fDigitBRN : String ;
    fDigitAccount : String ;

    TCPos : Integer;

    SCheqEnd:String;

    SBookQty : Integer;

begin
    fAccountAdd1 := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_Address1').AsString)  ;
    fAccountAdd2 := trim(ViewAccount.DataController.DataSet.FieldByName('ACC_Address2').AsString)  ;


    MICRData := '                                                                 ' ;
    DocTotal := 0;
    if(fFDDocUsed) then  DocTotal := DocTotal + fFDDocQty ;
    if(fBDDocUsed) then  DocTotal := DocTotal + (fBDDocQty) ;
    if(fRDDocUsed) then  DocTotal := DocTotal + fRDDocQty ;
    if(fBCDocUsed) then  DocTotal := DocTotal + fBCDocQty ;

                             
    GetBankDefault ; GetBRNDefault ;

       SetLength(APrintL1H1,fFDCharNum) ;
       SetLength(AprintL2H1,fFDCharNum) ;
       SetLength(APrintL3H1,fFDCharNum) ;
       SetLength(AprintL4H1,fFDCharNum) ;

       SetLength(APrintL1H2,fFDCharNum) ;
       SetLength(AprintL2H2,fFDCharNum) ;
       SetLength(APrintL3H2,fFDCharNum) ;
       SetLength(AprintL4H2,fFDCharNum) ;
       DocTotal := 0;
       if(fFDDocUsed) then  DocTotal := DocTotal + fFDDocQty ;
       if(fBDDocUsed) then  DocTotal := DocTotal + (fBDDocQty) ;
       if(fRDDocUsed) then  DocTotal := DocTotal + fRDDocQty ;
       if(fBCDocUsed) then  DocTotal := DocTotal + fBCDocQty ;
       FDQty := fFDDocStRun+(fFDDocQty-1) ;
       //BDQty := fBDDocStRun+(fBDDocQty-1) ;
       BDQty := fBDDocStRun+(fBDDocQty-1) ;
       RDQty := fRDDocStRun+(fRDDocQty-1) ;
       BCQty := fBCDocStRun+(fBCDocQty-1) ;

       SBookQty := strtoint(edtBookQty.Text);

       suiProgressBar1.Max := DocTotal * StrToIntDef(trim(edtBookQty.Text),0) ;
       CheckStart := StrToIntDef(trim(edtChequeNO.Text),0) ;
       CheckNext := StrToIntDef(trim(edtChequeNO.Text),0)  ;

        SCheqEnd := FormatFloat('0000000',CheckStart+((fBDDocQty)*SBookQty)-1);

  for RunDoc := 1 to StrToIntDef(trim(edtBookQty.Text),0)  do
   begin

        for REC := 0 to 64 do
      begin
        MICR2[Rec] := ' ' ;
      end;



      MICRData := '' ;
     CheckStart := CheckNext ;
//    Showmessage(IntTostr(Length(MICRData))) ;
      for REC := 1 to DocTotal do
        begin
          if( REC in [fFDDocStRun..FDQty]) and fFDDocUsed then
            begin

                 if(fFDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckStart) ;
                  StPosi := 64 - (fFDEStubChequeNoPOS-1);
                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;


                  if(fFDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-7] :=  fFDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fFDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckStart) ;
                  StPosi := 64-(fFDEChequeNoPOS-1) ;

                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;

                  if(fFDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fFDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;
                 //============================


               if(fFDEBankID = 1) then
                 begin
                  StPosi := 64-(fFDEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBank),1,1) ;

                  if(fFDESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fFDESBBankID ;

                    end else
                    begin

                    end;
                 end;



               if(fFDEBRNID = 1) then
                 begin
                  StPosi := 64- (fFDEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),1,1) ;

                  if(fFDESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fFDESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fFDEAccountID = 1) then
                 begin
                  StPosi := 64-(fFDEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;


                  if(fFDESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fFDESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fFDETC = 1) then
                 begin

                  StPosi := 64-(fFDETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fFDESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fFDESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fFDEAmount = 1) then
                 begin
                  StPosi := 64- (fFDEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',StrToIntdef(edtAmount.Text,0)) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fFDESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fFDESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fFDEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fFDEChequeEndPOS-1) ;
                      LastNi := CheckStart + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('00000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        MICR2[StPosi] := Copy(TempAMT,8,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-7] := Copy(TempAMT,1,1) ;
                      end;


                  if(fFDESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fFDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;


                for Rec1 := 0 to 64 do
                  begin

                    MICRData := MICRData + MICR2[Rec1] ;
                  end;


//=================  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fFDPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to CheckStart-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Formatfloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================
                       
                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fFDCharNum-1) do
                      //for Rec3 := 0 to (fFDCharNum) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;

                     for Rec3 := 1 to fFDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fFDPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           //APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,34)),Rec1+1,1) ;
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
                          end;
                      end  ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;

                        PrintL1H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;

                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fFDPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fFDPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;





                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fFDPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fFDPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;





                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fFDPStart > 0) then
                  begin


                     for Rec3 := 1 to fFDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fFDPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fFDPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fFDPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fFDPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckStart))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('00000000',CheckStart),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fFDPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fFDPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fFDPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fFDPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;





                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;






                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_FD_P_L1_H1, ECD_FD_P_L2_H1, ECD_FD_P_L3_H1, ECD_FD_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                    QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;

            end ; // else

//==Body==
          if( REC in [fBDDocStRun..BDQty]) and fBDDocUsed then
            begin
            //ShowMessage(inttostr(BDQty));

              for REC1 := 0 to 64 do
                begin
                 MICR2[Rec1] := ' ' ;
                end;

                MICRData := '' ;

               fDigitSerial :=  FormatFloat('0000000',CheckNext) ;

               if(fBDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckNext) ;
                  StPosi := 64 - (fBDEStubChequeNoPOS-1);
                  //MICR2[StPosi] := Copy(TempCHQ,8,1) ;
                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;


                  if(fBDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-7] :=  fBDESBStubChequeNo ;
                       MICR2[StPosi+1] :=  fBDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fBDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckNext) ;
                  StPosi := 64-(fBDEChequeNoPOS-1) ;

                  MICR2[StPosi] := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;
                  //MICR2[StPosi-7] := Copy(TempCHQ,1,1) ;

                  if(fBDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fBDESBChequeNo ;
                     MICR2[StPosi-7] :=  fBDESBChequeNo ;


                    end else
                    begin

                    end;
                 end;

                 fDigitBank := fBank ;

               if(fBDEBankID = 1) then
                 begin
                  StPosi := 64-(fBDEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;

                  if(fBDESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fBDESBBankID ;


                    end else
                    begin

                    end;
                 end;

                 fDigitBRN := fBrn ;

               if(fBDEBRNID = 1) then
                 begin
                  StPosi := 64- (fBDEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;

                  if(fBDESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fBDESBBRNID ;

                    end else
                    begin

                    end;
                 end;

                fDigitAccount := copy(edtAccountID.Text,1,10) ;

                if(fBDEAccountID = 1) then
                 begin
                  StPosi := 64-(fBDEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fBDESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBDESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fBDETC = 1) then
                 begin

                  StPosi := 64-(fBDETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fBDESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBDESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fBDEAmount = 1) then
                 begin
                  StPosi := 64- (fBDEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',StrToIntdef(edtAmount.Text,0)) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fBDESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBDESBAmount ;
                     MICR2[StPosi-11] := fBDESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fBDEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fBDEChequeEndPOS-1) ;
                      LastNi := StrToIntDef(trim(edtChequeNO.Text),0) + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('00000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                  MICR2[StPosi] := Copy(TempAMT,8,1) ;
                  MICR2[StPosi-1] := Copy(TempAMT,7,1) ;
                  MICR2[StPosi-2] := Copy(TempAMT,6,1) ;
                  MICR2[StPosi-3] := Copy(TempAMT,5,1) ;
                  MICR2[StPosi-4] := Copy(TempAMT,4,1) ;
                  MICR2[StPosi-5] := Copy(TempAMT,3,1) ;
                  MICR2[StPosi-6] := Copy(TempAMT,2,1) ;
                  MICR2[StPosi-7] := Copy(TempAMT,1,1) ;
                      end;


                  if(fBDESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;

                 fDigitCode := GetCheeckDigit(fDigitSerial,fDigitBank,fDigitBRN,fDigitAccount) ;
                //===================
                 {MICR2[14] := ';' ;
                 MICR2[15] := copy(fDigitCode,2,1) ;
                 MICR2[16] := copy(fDigitCode,1,1) ; }

                //====================
                 {MICR2[13] := ' ' ;
                 MICR2[14] := ' ' ;
                 MICR2[15] := ' ' ;
                 MICR2[16] := ' ' ;}

                 MICR2[14] := ' ' ;
                 MICR2[15] := ' ' ;
                 MICR2[16] := ' ' ;
                 MICR2[17] := ' ' ;


                //====================

                if (EdtTC.Text <> '') then
                begin
                     TCPos := strtoint(EdTC_Pos.Text);
                     StPosi := 64- (TCPos-1) ;
                     MICR2[StPosi] := Copy(edtTC.text,2,1) ;
                     MICR2[StPosi-1] := Copy(edtTC.text,1,1) ;
                end;



                    for Rec1 := 0 to 64 do
                      begin
                        MICRData := MICRData + MICR2[Rec1] ;
                      end;


    //                  MICrList.Caption := MICRData ;


//=================  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBDPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================
//                      TempSP := '' ;
//                      PrintL1H1F1 := '' ;





//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;
                        if(TempSP <> '') then PrintL1H1F1 := TempSP + PrintL1H1F1  ;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;
                        TempSP := '' ;

                     for Rec3 := 1 to fBDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBDPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;

                         PrintL1H1F2 :=  '' ;
                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBDPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBDPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                       for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                      PrintL2H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBDPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBDPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                      PrintL3H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fBDPStart > 0) then
                  begin


                     for Rec3 := 1 to fBDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBDPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fBDPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBDPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fBDPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('00000000',CheckNext))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(formatFloat('00000000',CheckNext),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBDPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBDPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBDPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBDPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL4H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;



                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_BD_P_L1_H1, ECD_BD_P_L2_H1, ECD_BD_P_L3_H1, ECD_BD_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                     QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;
                CheckNext := CheckNext+ 1 ;

            end  ; //           else
          if( REC in [fRDDocStRun..RDQty]) and fRDDocUsed then
            begin
              for REC1 := 0 to 64 do
                begin
                 MICR2[Rec1] := ' ' ;
                end;

                MICRData := '' ;

               if(fRDEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckStart) ;
                  StPosi := 64 - (fRDEStubChequeNoPOS-1);

                  MICR2[StPosi]  := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;


                  if(fRDESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-8] :=  fRDESBStubChequeNo ;

                    end ; //else

                 end;


               if(fRDEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',CheckStart) ;
                  StPosi := 64-(fRDEChequeNoPOS-1) ;


                  MICR2[StPosi]   := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;


                  if(fRDESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fRDESBChequeNo ;

                    end else
                    begin

                    end;
                 end;


               if(fRDEBankID = 1) then
                 begin
                  StPosi := 64-(fRDEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;

                  if(fRDESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fRDESBBankID ;


                    end else
                    begin

                    end;
                 end;



               if(fRDEBRNID = 1) then
                 begin
                  StPosi := 64- (fRDEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;

                  if(fRDESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fRDESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fRDEAccountID = 1) then
                 begin
                  StPosi := 64-(fRDEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fRDESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fRDESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fRDETC = 1) then
                 begin

                  StPosi := 64-(fRDETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fRDESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fRDESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fRDEAmount = 1) then
                 begin
                  StPosi := 64- (fRDEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',CheckStart) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fRDESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fRDESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fRDEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fRDEChequeEndPOS-1) ;
                      LastNi := CheckStart + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('0000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        MICR2[StPosi] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,1,1) ;
                      end;


                  if(fRDESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fRDESBChequeNo ;
                    end else
                    begin

                    end;
                 end;



                for Rec1 := 0 to 64 do
                  begin
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;

//                  MICrList.Caption := MICRData ;


// ==============  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fRDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fRDPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;

                     for Rec3 := 1 to fBDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fRDPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;

                      PrintL1H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fRDPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fRDStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fRDPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                      PrintL2H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fRDPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fRDStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fRDPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                       for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                        PrintL3H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fRDPStart > 0) then
                  begin


                     for Rec3 := 1 to fRDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fRDPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fRDPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                       for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fFDStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fRDPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fRDPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fRDPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                       for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fRDPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fRDPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fRDPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                        PrintL4H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;



//                     Showmessage(IntTostr(Length(MICRData))) ;
                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_RD_P_L1_H1, ECD_RD_P_L2_H1, ECD_RD_P_L3_H1, ECD_RD_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                     QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;

                      //ShowMessage(inttostr(BDQty));

            end  ; //           else
          if( REC in [fBCDocStRun..BCQty]) and fBCDocUsed then
            begin
               for REC1 := 0 to 64 do
                begin
                 MICR2[Rec1] := ' ' ;
                end;

                MICRData := '' ;

               if(fBCEStubChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('0000000',StrToIntDef(trim(edtChequeNO.Text),0)) ;
                  StPosi := 64 - (fBCEStubChequeNoPOS-1);
                  //= Copy(TempCHQ,8,1) ;
                  MICR2[StPosi]  := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;
                  //MICR2[StPosi-7]

                  if(fBCESBStubChequeNo <> 'N') then
                    begin
                       MICR2[StPosi-8] :=  fBCESBStubChequeNo ;

                    end ; //else

                 end;


               if(fBCEChequeNo = 1) then
                 begin
                  TempCHQ := FormatFloat('00000000',StrToIntDef(trim(edtChequeNO.Text),0)) ;
                  StPosi := 64-(fBCEChequeNoPOS-1) ;

                  //= Copy(TempCHQ,8,1) ;
                  MICR2[StPosi]  := Copy(TempCHQ,7,1) ;
                  MICR2[StPosi-1] := Copy(TempCHQ,6,1) ;
                  MICR2[StPosi-2] := Copy(TempCHQ,5,1) ;
                  MICR2[StPosi-3] := Copy(TempCHQ,4,1) ;
                  MICR2[StPosi-4] := Copy(TempCHQ,3,1) ;
                  MICR2[StPosi-5] := Copy(TempCHQ,2,1) ;
                  MICR2[StPosi-6] := Copy(TempCHQ,1,1) ;
                  //MICR2[StPosi-7]
                  if(fBCESBChequeNo <> 'N') then
                    begin
                     MICR2[StPosi+1] :=  fBCESBChequeNo ;

                    end else
                    begin

                    end;
                 end;


               if(fBCEBankID = 1) then
                 begin
                  StPosi := 64-(fBCEBankIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBank),3,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBank),2,1) ;

                  if(fBCESBBankID <> 'N') then
                    begin
                        MICR2[StPosi+1] := fBCESBBankID ;


                    end else
                    begin

                    end;
                 end;



               if(fBCEBRNID = 1) then
                 begin
                  StPosi := 64- (fBCEBRNIDPOS-1) ;
                  MICR2[StPosi] := Copy(trim(fBrn),4,1) ;
                  MICR2[StPosi-1] := Copy(trim(fBrn),3,1) ;
                  MICR2[StPosi-2] := Copy(trim(fBrn),2,1) ;

                  if(fBCESBBRNID <> 'N') then
                    begin
                    MICR2[StPosi+1] := fBCESBBRNID ;

                    end else
                    begin

                    end;
                 end;


                if(fBCEAccountID = 1) then
                 begin
                  StPosi := 64-(fBCEAccountIDPOS-1) ;

                  MICR2[StPosi]   := copy(edtAccountID.Text,10,1) ;
                  MICR2[StPosi-1] := copy(edtAccountID.Text,9,1) ;
                  MICR2[StPosi-2] := copy(edtAccountID.Text,8,1) ;
                  MICR2[StPosi-3] := copy(edtAccountID.Text,7,1) ;
                  MICR2[StPosi-4] := copy(edtAccountID.Text,6,1) ;
                  MICR2[StPosi-5] := copy(edtAccountID.Text,5,1) ;
                  MICR2[StPosi-6] := copy(edtAccountID.Text,4,1) ;
                  MICR2[StPosi-7] := copy(edtAccountID.Text,3,1) ;
                  MICR2[StPosi-8] := copy(edtAccountID.Text,2,1) ;
                  MICR2[StPosi-9] := copy(edtAccountID.Text,1,1) ;



                  if(fBCESBAccountID <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBCESBAccountID ;

                    end else
                    begin

                    end;
                 end;

                if(fBCETC = 1) then
                 begin

                  StPosi := 64-(fBCETCPOS-1) ;

                  MICR2[StPosi]   := copy(edtTC.Text,2,1) ;
                  MICR2[StPosi-1] := copy(edtTC.Text,1,1) ;


                  if(fBCESBTC <> 'N') then
                    begin
                      MICR2[StPosi+1] := fBCESBTC ;

                    end else
                    begin

                    end;
                 end;

                if(fBCEAmount = 1) then
                 begin
                  StPosi := 64- (fBCEAmountPOS-1) ;
                     TempAMT := FormatFloat('00000000000',StrToIntdef(edtAmount.Text,0)) ;
                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                         MICR2[StPosi] := copy(TempAMT,11,1) ;
                         MICR2[StPosi-1] := copy(TempAMT,10,1) ;
                         MICR2[StPosi-2] := copy(TempAMT,9,1) ;
                         MICR2[StPosi-3] := copy(TempAMT,8,1) ;
                         MICR2[StPosi-4] := copy(TempAMT,7,1) ;
                         MICR2[StPosi-5] := copy(TempAMT,6,1) ;
                         MICR2[StPosi-6] := copy(TempAMT,5,1) ;
                         MICR2[StPosi-7] := copy(TempAMT,4,1) ;
                         MICR2[StPosi-8] := copy(TempAMT,3,1) ;
                         MICR2[StPosi-9] := copy(TempAMT,2,1) ;
                         MICR2[StPosi-10] := copy(TempAMT,1,1) ;
                      end;


                  if(fBCESBAmount <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBCESBAmount ;

                    end else
                    begin

                    end;
                 end;


               if(fBCEChequeEnd = 1) then
                 begin
                  StPosi := 64- (fBCEChequeEndPOS-1) ;
                      LastNi := StrToIntDef(trim(edtChequeNO.Text),0) + (fBDDocQty-1) ;
                      TempAMT := FormatFloat('0000000',LastNi) ;

                     if(StrToIntDef(TempAMT,0) > 0) then
                       begin
                        MICR2[StPosi] := Copy(TempAMT,7,1) ;
                        MICR2[StPosi-1] := Copy(TempAMT,6,1) ;
                        MICR2[StPosi-2] := Copy(TempAMT,5,1) ;
                        MICR2[StPosi-3] := Copy(TempAMT,4,1) ;
                        MICR2[StPosi-4] := Copy(TempAMT,3,1) ;
                        MICR2[StPosi-5] := Copy(TempAMT,2,1) ;
                        MICR2[StPosi-6] := Copy(TempAMT,1,1) ;
                      end;


                  if(fBCESBChequeEnd <> 'N') then
                    begin
                     MICR2[StPosi+1] := fBCESBChequeNo ;

                    end else
                    begin

                    end;
                 end;



                for Rec1 := 0 to 64 do
                  begin
                    MICRData := MICRData + MICR2[Rec1] ;
                  end;

//                  MICrList.Caption := MICRData ;

//=================  Endos  Line 1
                TempSP := '' ;
                PrintL1H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBCPL1H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL1H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;


//                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                      for Rec3 := 0 to (fBCCharNum-1) do
                        begin
                          if(APrintL1H1[Rec3] <> ' ') then  PrintL1H1F1 := PrintL1H1F1 + APrintL1H1[Rec3] ;
                        end;

//                      if(TempSP <> '') then PrintL1H2F1 := PrintL1H2F1 + TempSP ;

                     for Rec3 := 1 to fFDStartH1L1 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL1H1[Rec1] := ' ';
                          end;


                    if(fBCPL1H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL1H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL1H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL1H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                       for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL1H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;
//                             AmountDisplay.Caption :=  ConVertMoney.Text ;
                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL1H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL1H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin
//                           APrintL1H1[Rec1] := Copy(('[DATE]'+formatdatetime('dd-mm-yyyy',Date)+'[ID]'+trim(edtAccountID.Text)),Rec1+1,1) ;
                          end;
                      end  ;


//                      if(TempSP <> '') then PrintL1H1F1 := PrintL1H1F1 + TempSP ;
                        PrintL1H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL1H1F2 := PrintL1H1F2 + APrintL1H1[Rec3] ;
                        end;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;

                        PrintL1H1F1 := PrintL1H1F1 +' '+PrintL1H1F2 ;


//                      Showmessage(IntToStr(length(TempSP))) ;
                        PrintL1H1F2 := '' ;
//
                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL1H1F2 := PrintL1H1F2 + Copy(PrintL1H1F1,Rec3+1,1) ;

                        end;
                          PrintL1H1F1 := PrintL1H1F2 ;
//                        ShowMessage(IntToStr(Length(PrintL1H1))) ;
                  end;



//===============================================================================
//    Lime 2
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL2H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBCPL2H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL2H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL2H1F1 := PrintL2H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL2H1[Rec3] <> ' ') then  PrintL2H1F1 := PrintL2H1F1 + APrintL2H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBCStartH1L2 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fBCCharNum -1 do
                          begin
                            APrintL2H1[Rec1] := ' ';
                          end;


                    if(fBCPL2H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL2H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL2H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                       for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL2H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL2H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL2H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL2H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL2H1F2 := PrintL2H1F2 + APrintL2H1[Rec3] ;
                        end;


                        PrintL2H1F1 := PrintL2H1F1 +' '+PrintL2H1F2 ;



                        PrintL2H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL2H1F2 := PrintL2H1F2 + Copy(PrintL2H1F1,Rec3+1,1) ;

                        end;
                          PrintL2H1F1 := PrintL2H1F2 ;

                  end;


//===============================================================================
//    Lime 3
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL3H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fBCCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBCPL3H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL3H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                         for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL3H1F1 := PrintL3H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL3H1[Rec3] <> ' ') then  PrintL3H1F1 := PrintL3H1F1 + APrintL3H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBCStartH1L3 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL3H1[Rec1] := ' ';
                          end;


                    if(fBCPL3H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL3H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL1H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL3H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL3H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL2H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                         for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL3H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL3H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL3H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL3H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL3H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL3H1F2 := PrintL3H1F2 + APrintL3H1[Rec3] ;
                        end;


                        PrintL3H1F1 := PrintL3H1F1 +' '+PrintL3H1F2 ;



                        PrintL3H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL3H1F2 := PrintL3H1F2 + Copy(PrintL3H1F1,Rec3+1,1) ;

                        end;
                          PrintL3H1F1 := PrintL3H1F2 ;

                  end;


//===============================================================================
//    Lime  4
//
//
//
//==============================================================================

                TempSP := '' ;
                PrintL4H1F1 := '' ;

                if(fBCPStart > 0) then
                  begin


                     for Rec3 := 1 to fBCStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBCPL4H1F1 = 'None0') then
                      begin

                      end else
                     if(fBCPL4H1F1 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F1 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PACNA') then
                      begin
                        //for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                         for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F1 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F1 = 'PPREN') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F1 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;
//========================================
//
//
//
//
//========================================

                      if(TempSP <> '') then PrintL4H1F1 := PrintL4H1F1 + TempSP ;



                      for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                          if(APrintL4H1[Rec3] <> ' ') then  PrintL4H1F1 := PrintL4H1F1 + APrintL4H1[Rec3] ;
                        end;


                     for Rec3 := 1 to fBCStartH1L4 do
                       begin
                         TempSP := TempSP + ' ' ;
                       end;

                       for Rec1 := 0 to fFDCharNum -1 do
                          begin
                            APrintL4H1[Rec1] := ' ';
                          end;


                    if(fBCPL4H1F2 = 'None0') then
                      begin

                      end else
                     if(fBCPL4H1F2 = 'PSCN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(edtChequeNO.Text))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtChequeNO.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBank))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(fBank,Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankName))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankName),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd1),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBKCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PBKBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBankReg))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBankReg),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PBRC0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBrn))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBrn),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBRN0') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchName))-1 do
                          begin
                           APrintL4H2[Rec1] := Copy(Trim(fBranchName),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F2 = 'PBRA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd1),Rec1+1,1) ;
                          end;

                      end else
                     if(fBCPL4H1F2 = 'PBRA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchAdd2),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PBRCT') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchCity))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchCity),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PBRBR') then
                      begin
                        for Rec1 := 0 to Length(Trim(fBranchRegion))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fBranchRegion),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PACID') then
                      begin
                        for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,1,10)))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(edtAccountID.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PACNA') then
                      begin
                       // for Rec1 := 0 to Length(Trim(Copy(edtAccountID.Text,11,34)))-1 do
                        for Rec1 := 0 to Length(Copy(edtAccountID.Text,11,34))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(Copy(edtAccountID.Text,11,36)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PACA1') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd1))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd1),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PACA2') then
                      begin
                        for Rec1 := 0 to Length(Trim(fAccountAdd2))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(fAccountAdd2),Rec1+1,1) ;
                          end;
                      end else

                     if(fBCPL4H1F2 = 'PEPRE') then
                      begin
                        for Rec1 := 0 to Length(formatFloat('#,###,###,###,###.00',fPrice))-1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(formatFloat('#,###,###,###,###.00',fPrice)),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PPRTH') then
                      begin
                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := Thai ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to Length(Trim(ConVertMoney.Text))-1 do
                          begin

                             APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end else
                     if(fBCPL4H1F2 = 'PPREN') then
                      begin

                             ConVertMoney := Tn2wMoney.Create(nil);
                             ConVertMoney.Language := English ;
                             ConVertMoney.Value := StrToFloatDef(DoStang(edtAmount.Text,false),0) ;

                        for Rec1 := 0 to fFDCharNum -1 do
                          begin
                           APrintL4H1[Rec1] := Copy(Trim(ConVertMoney.Text),Rec1+1,1) ;
                          end;
                      end  else
                     if(fBCPL4H1F2 = 'PTPRI') then
                      begin
                        for Rec1 := 0 to 34 do
                          begin

                          end;
                      end  ;



                       PrintL4H1F2 :=  '' ;

                      for Rec3 := 0 to (fFDCharNum-1-(Length(TempSP))) do
                        begin
                          PrintL4H1F2 := PrintL4H1F2 + APrintL4H1[Rec3] ;
                        end;


                        PrintL4H1F1 := PrintL4H1F1 +' '+PrintL4H1F2 ;



                        PrintL4H1F2 := '' ;

                     for Rec3 := 0 to (fFDCharNum-1) do
                        begin
                           PrintL4H1F2 := PrintL4H1F2 + Copy(PrintL4H1F1,Rec3+1,1) ;

                        end;
                          PrintL4H1F1 := PrintL4H1F2 ;

                  end;



                    DBDetail := TADOQuery.Create(nil);

                     with DBDetail do
                      begin
                        Connection := frmDataCenter.ADOConnection1 ;
                        SQL.Clear ;
                        SQL.Text := ' Insert into DBRunDetails '+
                                    ' (ECD_JobID, ECD_FD_MICR, ECD_BC_P_L1_H1, ECD_BC_P_L2_H1, ECD_BC_P_L3_H1, ECD_BC_P_L4_H1, ECD_Status ) '+
                                    ' Values ( '+
                                    QuotedStr(fJOBNO)+','+
                                    QuotedStr(MICRData)+','+
                                    QuotedStr(PrintL1H1F1)+','+
                                    QuotedStr(PrintL2H1F1)+','+
                                    QuotedStr(PrintL3H1F1)+','+
                                    QuotedStr(PrintL4H1F1)+','+

                                     QuotedStr('W')+
                                    ' ) ' ;
                        ExecSQL ;
                        Free ;
                      end;


            end;
            suiProgressBar1.StepIt ;

        end;
    end;
    //ShowMessage('TransID= '+fJOBNO+' ' +'DocNM= '+inttostr(fBDDocQty)+' '+'ChkEnd ='+SCheqEnd);
    UpdBDDocQty(fJOBNO,SCheqEnd);
end;
//++++++++++



end.
